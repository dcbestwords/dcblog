import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as e,c,e as a,a as n,b as s}from"./app-B6A2eMDJ.js";const o="/dcBlog/assets/compare-Ct7H-ISV.png",p="/dcBlog/assets/1-BlOQ6Fhm.png",l="/dcBlog/assets/effect-CORNZS73.png",i="/dcBlog/assets/get-CW6_V0ya.png",u="/dcBlog/assets/set-vpuyeiAH.png",r="/dcBlog/assets/weakmap-B58Lr_gW.png",k="/dcBlog/assets/image-20230517192740314-SYbdWzh3.png",d="/dcBlog/assets/image-20230517182210993-Dl53BX8A.png",v="/dcBlog/assets/image-20230517182421551-ZYnBPMkX.png",m="/dcBlog/assets/image-20230518153811983-0Dd8P1Sx.png",b="/dcBlog/assets/image-20230519093732138-BOD41LmM.png",f={},g=a(`<h1 id="vueçš„è®¾è®¡ä¸å®ç°-1-4ç« " tabindex="-1"><a class="header-anchor" href="#vueçš„è®¾è®¡ä¸å®ç°-1-4ç« "><span>vueçš„è®¾è®¡ä¸å®ç°ï¼ˆ1-4ç« ï¼‰</span></a></h1><blockquote><p>éœæ˜¥é˜³ã€ŠVue.jsè®¾è®¡ä¸å®ç°ã€‹çš„ç¬”è®°</p></blockquote><h2 id="ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©-æƒè¡¡" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©-æƒè¡¡"><span>ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©ï¼ˆæƒè¡¡ï¼‰</span></a></h2><h3 id="_1-å£°æ˜å¼orå‘½ä»¤å¼" tabindex="-1"><a class="header-anchor" href="#_1-å£°æ˜å¼orå‘½ä»¤å¼"><span>1. å£°æ˜å¼orå‘½ä»¤å¼</span></a></h3><p><strong>å‘½ä»¤å¼ï¼ˆå…³æ³¨è¿‡ç¨‹ï¼‰</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span> <span class="token comment">// è·å– div</span>
div<span class="token punctuation">.</span>innerText <span class="token operator">=</span><span class="token string">&#39;hello world&#39;</span> <span class="token comment">// è®¾ç½®æ–‡æœ¬å†…å®¹</span>
div<span class="token punctuation">.</span><span class="token function">addEventlistener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token function">ï¼Œ</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">[</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;ok&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ç»‘å®šç‚¹å‡»äº‹ä»¶</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å£°æ˜å¼ï¼ˆå…³æ³¨ç»“æœï¼‰</strong></p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>()=&gt; alert(&#39;ok&#39;)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>hello world<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿™éƒ¨åˆ†çš„é€‰æ‹©ä¸»è¦åŸºäºä¸¤ä¸ªæ–¹é¢ï¼š<strong>æ€§èƒ½</strong>å’Œ<strong>å¯ç»´æŠ¤æ€§</strong>ã€‚</p><table><thead><tr><th style="text-align:center;"></th><th style="text-align:center;">æ€§èƒ½</th><th style="text-align:center;">å¯ç»´æŠ¤æ€§</th></tr></thead><tbody><tr><td style="text-align:center;">å¯¹æ¯”</td><td style="text-align:center;">å‘½ä»¤å¼ &gt; å£°æ˜å¼</td><td style="text-align:center;">å£°æ˜å¼ &gt;&gt; å‘½ä»¤å¼</td></tr></tbody></table><ul><li>å› ä¸ºå£°æ˜å¼åœ¨å‘½ä»¤å¼æ€§èƒ½æ¶ˆè€—çš„åŸºç¡€ä¸Šå¤šå‡ºäº†<strong>diffçš„æ€§èƒ½æ¶ˆè€—</strong>ï¼Œæ‰€ä»¥åœ¨æ€§èƒ½ä¸Šä¼šå·®ä¸€äº›</li><li>ä½†éšä¹‹å¸¦æ¥çš„æ˜¯å¯ç»´æŠ¤æ€§çš„å·¨å¤§æå‡</li></ul><blockquote><p>Vueå°è£…å‘½ä»¤å¼çš„ä»£ç ï¼Œå®ç°é¢å‘ç”¨æˆ·çš„å£°æ˜å¼</p></blockquote><h3 id="_2-è™šæ‹Ÿdomçš„é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#_2-è™šæ‹Ÿdomçš„é€‰æ‹©"><span>2. è™šæ‹Ÿdomçš„é€‰æ‹©</span></a></h3><p>ä¸Šé¢æåˆ°å£°æ˜å¼å¸¦æ¥çš„é¢å¤–æ€§èƒ½æ¶ˆè€—â€”â€”<strong>diffçš„æ€§èƒ½æ¶ˆè€—</strong>ï¼Œè™šæ‹Ÿdomä¾¿æ˜¯ä¸ºäº†æœ€å°åŒ–æ­¤æ¶ˆè€—é‡‡å–çš„æªæ–½ã€‚å…¶ä¸­è™šæ‹Ÿdomæ˜¯ä¸€ä¸ªæ™®é€šçš„JSå¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºå¯¹çœŸå®domçš„æè¿°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;span&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">&#39;hello world&#39;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+o+`" alt="image-20230321131551437" tabindex="0" loading="lazy"><figcaption>image-20230321131551437</figcaption></figure><h3 id="_3-è¿è¡Œæ—¶orç¼–è¯‘æ—¶" tabindex="-1"><a class="header-anchor" href="#_3-è¿è¡Œæ—¶orç¼–è¯‘æ—¶"><span>3. è¿è¡Œæ—¶orç¼–è¯‘æ—¶</span></a></h3><ul><li>è¿è¡Œæ—¶ <ul><li>åˆ©ç”¨ <code>render</code> å‡½æ•°ï¼Œç›´æ¥æŠŠ <mark>è™šæ‹ŸDOM</mark> è½¬åŒ–ä¸º <mark>çœŸå®DOM</mark> å…ƒç´ </li><li>æ²¡æœ‰ç¼–è¯‘è¿‡ç¨‹ï¼Œæ— æ³•åˆ†æç”¨æˆ·æä¾›çš„å†…å®¹</li><li>éœ€è¦æˆ‘ä»¬æ‰‹å†™<code>render</code>å‡½æ•°ï¼ˆğŸ˜–ï¼‰</li></ul></li><li>ç¼–è¯‘æ—¶ <ul><li>ç›´æ¥æŠŠ <mark>template æ¨¡æ¿</mark> ä¸­çš„å†…å®¹ï¼Œè½¬åŒ–ä¸º <mark>çœŸå® DOM</mark> å…ƒç´ </li><li>å¯ä»¥åˆ†æç”¨æˆ·æä¾›çš„å†…å®¹ï¼Œç†è®ºä¸Šæ€§èƒ½ä¼šæ›´å¥½ï¼Œä½†æ˜¯æœ‰æŸçµæ´»æ€§</li></ul></li><li>è¿è¡Œæ—¶ç¼–è¯‘ï¼ˆVueé€‰ç”¨ï¼‰ <ul><li>å…ˆæŠŠ <mark>template æ¨¡æ¿</mark> è½¬åŒ–ä¸º <mark>render å‡½æ•°</mark></li><li>å†åˆ©ç”¨render å‡½æ•°ï¼ŒæŠŠ <mark>è™šæ‹Ÿ DOM</mark> è½¬åŒ–ä¸º <mark>çœŸå® DOM</mark></li></ul></li></ul><h2 id="äºŒã€-æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒè¦ç´ " tabindex="-1"><a class="header-anchor" href="#äºŒã€-æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒè¦ç´ "><span>äºŒã€ æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒè¦ç´ </span></a></h2><ul><li><p>æå‡ç”¨æˆ·çš„å¼€å‘ä½“éªŒ</p><ul><li>å¼•å…¥å‹å¥½çš„è­¦å‘Šä¿¡æ¯ï¼Œå¸®åŠ©å¼€å‘è€…é‡Œå¿«é€Ÿå®šä½é—®é¢˜</li><li>è­¦å‘Šä¿¡æ¯è¯¦ç»†å¯¼è‡´æ¡†æ¶ä½“ç§¯å¢å¤§ï¼Œé€šè¿‡åˆ¤æ–­æ‰€å¤„ç¯å¢ƒæ¥å†³å®šæ„å»ºçš„ç‰ˆæœ¬æ˜¯å¦åŒ…å«è¿™äº›è­¦å‘Šä¿¡æ¯</li></ul></li><li><p>å¼•å…¥<code>Tree-Shaking</code>æœºåˆ¶</p><ul><li>é…åˆé¢„å®šä¹‰å˜é‡ï¼Œæ’é™¤dead codeï¼Œç¼©å°æ‰“åŒ…ä½“ç§¯</li></ul></li><li><p>æ ¹æ®åº”ç”¨ç¯å¢ƒçš„ä¸åŒè¾“å‡ºä¸åŒçš„æ„å»ºäº§ç‰©ï¼ˆ <mark>å¤šç‰ˆæœ¬</mark>ï¼‰</p></li><li><p>æä¾›åŠŸèƒ½çš„ç‰¹æ€§å¼€å…³ï¼Œè®©ç”¨æˆ·è‡ªç”±é€‰æ‹©æ˜¯å¦ä½¿ç”¨</p></li><li><p>æä¾›ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æ¥å£ï¼š<code>callWithErrorHandling</code></p></li><li><p>æä¾›è‰¯å¥½çš„TSç±»å‹æ”¯æŒ</p></li></ul><h2 id="ä¸‰ã€vue3çš„è®¾è®¡æ€è·¯" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€vue3çš„è®¾è®¡æ€è·¯"><span>ä¸‰ã€Vue3çš„è®¾è®¡æ€è·¯</span></a></h2><h3 id="_1-æè¿°ui" tabindex="-1"><a class="header-anchor" href="#_1-æè¿°ui"><span>1. æè¿°UI</span></a></h3><p>Vue3ä¸­æ”¯æŒä¸¤ç§æ–¹å¼æ¥æè¿°UIã€‚ç¬¬ä¸€ç§æ˜¯ <mark>æ¨¡æ¿</mark>ï¼Œå³æˆ‘ä»¬å¸¸åœ¨templateæ ‡ç­¾ä¸­ä¹¦å†™çš„å†…å®¹ï¼š</p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handler<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>è¿™ç§æ–¹å¼vueæœ€ç»ˆè¿˜æ˜¯ä¼šå°†å…¶ç¼–è¯‘ä¸º<code>render</code>å‡½æ•°ï¼ˆé€šè¿‡<strong>ç¼–è¯‘å™¨</strong>ï¼‰</li></ul><p>å¦å¤–ä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨jså¯¹è±¡æ¥æè¿°UIï¼Œå³æ‰€è°“çš„ <mark>è™šæ‹ŸDOM</mark>ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">&#39;h1&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">onClick</span><span class="token operator">:</span> handler <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// è™šæ‹Ÿ DOM</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>render</code>å‡½æ•°è¿è¡Œè¿”å›ä¸€ä¸ªè™šæ‹ŸDOMå¯¹è±¡</li><li>å…¶ä¸­hä¸ºè¾…åŠ©åˆ›å»ºè™šæ‹ŸDOMçš„å·¥å…·å‡½æ•°</li></ul><h3 id="_2-æ¸²æŸ“å™¨" tabindex="-1"><a class="header-anchor" href="#_2-æ¸²æŸ“å™¨"><span>2. æ¸²æŸ“å™¨</span></a></h3><p>æ¸²æŸ“å™¨çš„ä½œç”¨å°±æ˜¯ <mark>æŠŠè™šæ‹Ÿ DOM æ¸²æŸ“ä¸ºçœŸå® DOM</mark>ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªä¸è€ƒè™‘æ›´æ–°èŠ‚ç‚¹çš„ç®€æ˜“ç‰ˆæœ¬</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">renderer</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä½¿ç”¨ vnode.tag ä½œä¸ºæ ‡ç­¾åç§°åˆ›å»º DOM å…ƒç´ </span>
    <span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>tag<span class="token punctuation">)</span>
    <span class="token comment">// éå† vnode.propsï¼Œå°†å±æ€§ã€äº‹ä»¶æ·»åŠ åˆ° DOM å…ƒç´ </span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^on</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœ key ä»¥ on å¼€å¤´ï¼Œè¯´æ˜å®ƒæ˜¯äº‹ä»¶</span>
            el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
                key<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// äº‹ä»¶åç§° onClick ---&gt;click</span>
                vnode<span class="token punctuation">.</span>props<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token comment">// äº‹ä»¶å¤„ç†å‡½æ•°</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¤„ç† children</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>children <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¦‚æœ children æ˜¯å­—ç¬¦ä¸²ï¼Œè¯´æ˜å®ƒæ˜¯å…ƒç´ çš„æ–‡æœ¬å­èŠ‚ç‚¹</span>
        el<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// é€’å½’åœ°è°ƒç”¨ renderer å‡½æ•°æ¸²æŸ“å­èŠ‚ç‚¹ï¼Œä½¿ç”¨å½“å‰å…ƒç´  el ä½œä¸ºæŒ‚è½½ç‚¹</span>
        vnode<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token function">renderer</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å°†å…ƒç´ æ·»åŠ åˆ°æŒ‚è½½ç‚¹ä¸‹</span>
    container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_3-ç»„ä»¶"><span>3. ç»„ä»¶</span></a></h3><p><mark>ç»„ä»¶å°±æ˜¯ä¸€ç»„DOMå…ƒç´ çš„å°è£…</mark>ï¼Œè¿™ç»„DOMå…ƒç´ å°±æ˜¯ç»„ä»¶è¦æ¸²æŸ“çš„å†…å®¹ã€‚è€Œè™šæ‹ŸDOMä¸å…‰å¯ä»¥ç”¨æ¥æè¿°çœŸå®DOMï¼Œè¿˜å¯ä»¥ç”¨æ¥æè¿°ç»„ä»¶ï¼Œåªæ˜¯å…¶ä¸­<code>tag</code>å˜æˆäº†ç»„ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> MyComponent
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">//MyComponentæ˜¯ä¸€ä¸ªå¯¹è±¡</span>
<span class="token keyword">const</span> MyComponent <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">{</span>
            <span class="token literal-property property">tag</span><span class="token operator">:</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">props</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token function-variable function">onclick</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">alert</span> <span class="token punctuation">(</span><span class="token string">&#39;hello&#39;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">children</span><span class="token operator">:</span><span class="token string">&#39;click me&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//MyComponentæ˜¯ä¸€ä¸ªå‡½æ•°</span>
<span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;hello&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">&#39;click me&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>MyComponent</code>å¯ä»¥æ˜¯å‡½æ•°ï¼Œå¯ä»¥æ˜¯å¯¹è±¡ï¼Œåªè¦æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ç»„è™šæ‹Ÿdomå³å¯ã€‚æˆ‘ä»¬æ ¹æ®<code>MyComponent</code>çš„ç±»å‹å¯¹æ¸²æŸ“å™¨è¿›è¡Œç›¸åº”çš„ä¿®æ”¹</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">renderer</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¯´æ˜ vnode æè¿°çš„æ˜¯æ ‡ç­¾å…ƒç´ </span>
        <span class="token function">mountElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//æˆ–è€…=== &#39;Object&#39;</span>
        <span class="token comment">// è¯´æ˜ vnode æè¿°çš„æ˜¯ç»„ä»¶</span>
        <span class="token function">mountComponent</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­mountElementå³ä¸Šè¿°æ¸²æŸ“å™¨çš„éƒ¨åˆ†ï¼Œè€Œæ–°åŠ çš„å¤„ç†ç»„ä»¶çš„å‡½æ•°<code>mountComponent</code>ï¼Œå¤§è‡´æµç¨‹ä¸ºï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è°ƒç”¨ç»„ä»¶å‡½æ•°ï¼Œè·å–ç»„ä»¶è¦æ¸²æŸ“çš„å†…å®¹ï¼ˆè™šæ‹Ÿ DOMï¼‰</span>
    <span class="token keyword">const</span> subtree <span class="token operator">=</span> vnode<span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//vnode.tag.render()</span>
    <span class="token comment">// é€’å½’åœ°è°ƒç”¨ renderer æ¸²æŸ“ subtree</span>
    <span class="token function">renderer</span><span class="token punctuation">(</span>subtree<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-ç¼–è¯‘å™¨" tabindex="-1"><a class="header-anchor" href="#_4-ç¼–è¯‘å™¨"><span>4. ç¼–è¯‘å™¨</span></a></h3><p>ç¼–è¯‘å™¨çš„ä½œç”¨æ˜¯ <mark>å°†æ¨¡æ¿ç¼–è¯‘ä¸ºæ¸²æŸ“å‡½æ•°</mark>ï¼Œå¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œæ¨¡æ¿å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²ï¼Œå®ƒä¼šåˆ†æè¯¥å­—ç¬¦ ä¸²å¹¶ç”Ÿæˆä¸€ä¸ªåŠŸèƒ½ä¸ä¹‹ç›¸åŒçš„æ¸²æŸ“å‡½æ•°</p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handler<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    	click me
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;template&gt;</code> æ ‡ç­¾é‡Œçš„å†…å®¹å°±æ˜¯æ¨¡æ¿å†…å®¹ï¼Œç¼–è¯‘å™¨ä¼šæŠŠæ¨¡æ¿å†…å®¹ ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°å¹¶æ·»åŠ åˆ° <code>&lt;script&gt;</code>æ ‡ç­¾å—çš„ç»„ä»¶å¯¹è±¡ä¸Šï¼Œæ‰€ä»¥æœ€ç»ˆåœ¨æµè§ˆå™¨é‡Œè¿è¡Œçš„ä»£ç å°±æ˜¯ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">onClick</span><span class="token operator">:</span> handler <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;click me&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-é¡µé¢æ¸²æŸ“æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_5-é¡µé¢æ¸²æŸ“æµç¨‹"><span>5. é¡µé¢æ¸²æŸ“æµç¨‹</span></a></h3><figure><img src="`+p+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="å››ã€å“åº”ç³»ç»Ÿçš„ä½œç”¨ä¸å®ç°" tabindex="-1"><a class="header-anchor" href="#å››ã€å“åº”ç³»ç»Ÿçš„ä½œç”¨ä¸å®ç°"><span>å››ã€å“åº”ç³»ç»Ÿçš„ä½œç”¨ä¸å®ç°</span></a></h2><h3 id="_1-å“åº”å¼æ•°æ®ä¸å‰¯ä½œç”¨å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_1-å“åº”å¼æ•°æ®ä¸å‰¯ä½œç”¨å‡½æ•°"><span>1. å“åº”å¼æ•°æ®ä¸å‰¯ä½œç”¨å‡½æ•°</span></a></h3><p>â€‹ <strong>å‰¯ä½œç”¨å‡½æ•°</strong>æ˜¯æŒ‡ä¼šäº§ç”Ÿå‰¯ä½œç”¨çš„å‡½æ•°ï¼Œå³å®ƒä¼šç›´æ¥æˆ–é—´æ¥åœ°å½±å“å…¶ä»–å‡½æ•°çš„æ‰§è¡Œã€‚</p><figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è€Œ<strong>å“åº”å¼æ•°æ®</strong>æ˜¯æŒ‡ä¼šå¯¼è‡´è§†å›¾å˜åŒ–çš„æ•°æ®ã€‚</p><h3 id="_2-å®Œæˆå“åº”å¼çš„åŸºæœ¬æ€è·¯" tabindex="-1"><a class="header-anchor" href="#_2-å®Œæˆå“åº”å¼çš„åŸºæœ¬æ€è·¯"><span>2. å®Œæˆå“åº”å¼çš„åŸºæœ¬æ€è·¯</span></a></h3><p>æ‹¦æˆª<strong>å“åº”å¼æ•°æ®</strong>çš„å­˜å–è¡Œä¸ºï¼Œåœ¨è¯»å–æ•°æ®æ—¶ï¼Œå°†å‰¯ä½œç”¨å‡½æ•°å­˜åˆ°ä¸€ä¸ªâ€œæ¡¶â€é‡Œï¼›å½“è®¾ç½®æ•°æ®æ—¶ï¼Œå°†å‰¯ä½œç”¨å‡½æ•°ä»â€œæ¡¶â€é‡Œå–å‡ºæ‰§è¡Œã€‚</p><figure><img src="'+i+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><img src="'+u+`" alt style="zoom:33%;"></p><p>å…¶ä¸­æ‹¦æˆªå­˜å–çš„æ“ä½œï¼Œåœ¨Vue2ä¸­ä½¿ç”¨<code>Object.defineProperty</code>å®ç°ï¼›åœ¨Vue3ä¸­ä½¿ç”¨<code>Proxy</code>å®ç°ã€‚</p><blockquote><p>åŸºæœ¬æ€è·¯çš„å®ç°</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// å­˜å‚¨å‰¯ä½œç”¨å‡½æ•°çš„æ¡¶</span>
<span class="token keyword">const</span> bucket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åŸå§‹æ•°æ®</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;hello world&#39;</span> <span class="token punctuation">}</span>
<span class="token comment">// å¯¹åŸå§‹æ•°æ®çš„ä»£ç†</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ‹¦æˆªè¯»å–æ“ä½œ</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å°†å‰¯ä½œç”¨å‡½æ•° effect æ·»åŠ åˆ°å­˜å‚¨å‰¯ä½œç”¨å‡½æ•°çš„æ¡¶ä¸­</span>
        bucket<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>effect<span class="token punctuation">)</span>
        <span class="token comment">// è¿”å›å±æ€§å€¼</span>
        <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// æ‹¦æˆªè®¾ç½®æ“ä½œ</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è®¾ç½®å±æ€§å€¼</span>
        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newVal
        <span class="token comment">// æŠŠå‰¯ä½œç”¨å‡½æ•°ä»æ¡¶é‡Œå–å‡ºå¹¶æ‰§è¡Œ</span>
        bucket<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// è¿”å› true ä»£è¡¨è®¾ç½®æ“ä½œæˆåŠŸ</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-è¾ƒå®Œå–„å“åº”å¼çš„å®ç°" tabindex="-1"><a class="header-anchor" href="#_3-è¾ƒå®Œå–„å“åº”å¼çš„å®ç°"><span>3. è¾ƒå®Œå–„å“åº”å¼çš„å®ç°</span></a></h3><h4 id="ç¡¬ç¼–ç " tabindex="-1"><a class="header-anchor" href="#ç¡¬ç¼–ç "><span>ç¡¬ç¼–ç </span></a></h4><blockquote><p><strong>é—®é¢˜</strong>ï¼šç¡¬ç¼–ç ï¼Œå‰¯ä½œç”¨å‡½æ•°çš„åå­—å›ºå®šä¸ºeffectï¼Œå¯¼è‡´ä¸€æ—¦å‰¯ä½œç”¨å‡½æ•°çš„åå­—ä¸å« effectï¼Œé‚£ä¹ˆè¿™æ®µä»£ç å°±ä¸èƒ½æ­£ç¡®åœ°å·¥ä½œäº†ã€‚</p><p><strong>action</strong>ï¼šæ·»åŠ å‰¯ä½œç”¨å‡½æ•°æ³¨å†Œæœºåˆ¶</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// ç”¨ä¸€ä¸ªå…¨å±€å˜é‡å­˜å‚¨è¢«æ³¨å†Œçš„å‰¯ä½œç”¨å‡½æ•°</span>
<span class="token keyword">let</span> activeEffect
<span class="token comment">// effect å‡½æ•°ç”¨äºæ³¨å†Œå‰¯ä½œç”¨å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å½“è°ƒç”¨ effect æ³¨å†Œå‰¯ä½œç”¨å‡½æ•°æ—¶ï¼Œå°†å‰¯ä½œç”¨å‡½æ•° fn èµ‹å€¼ç»™activeEffect</span>
    activeEffect <span class="token operator">=</span> fn
    <span class="token comment">// æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ä½¿ç”¨æ—¶</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">effect</span><span class="token punctuation">(</span>
    <span class="token comment">// ä¸€ä¸ªåŒ¿åçš„å‰¯ä½œç”¨å‡½æ•°</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerText <span class="token operator">=</span> obj<span class="token punctuation">.</span>text
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>activeEffectä¿å­˜ç€å½“å‰çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œå‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œæ—¶è§¦å‘å“åº”å¼æ•°æ® obj.text çš„è¯»å–æ“ä½œï¼Œè¿›è€Œè§¦å‘ä»£ç†å¯¹è±¡ Proxy çš„ get æ‹¦æˆªå‡½æ•°ã€‚</p><p>ç›¸åº”åœ°å¯¹ä»£ç†æ“ä½œè¿›è¡Œæ”¹è¿›ï¼Œè¿™æ · <mark>å“åº”ç³»ç»Ÿå°±ä¸ä¾èµ–å‰¯ä½œç”¨å‡½æ•°çš„åå­—äº†</mark></p>`,66),h=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" obj "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Proxy"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å°† activeEffect ä¸­å­˜å‚¨çš„å‰¯ä½œç”¨å‡½æ•°æ”¶é›†åˆ°â€œæ¡¶â€ä¸­"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("activeEffect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token comment"},"//æ”¹è¿›"),s(`
            bucket`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("activeEffect"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(` 
        `),n("span",{class:"token keyword"},"return"),s(" target"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" newVal"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        target`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(` newVal
        bucket`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"true"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),y=a('<h4 id="æ¡¶-ç»“æ„çš„é‡æ–°è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#æ¡¶-ç»“æ„çš„é‡æ–°è®¾è®¡"><span>&quot;æ¡¶&quot;ç»“æ„çš„é‡æ–°è®¾è®¡</span></a></h4><blockquote><p><strong>é—®é¢˜</strong>ï¼šæ²¡æœ‰åœ¨å‰¯ä½œç”¨å‡½æ•°ä¸è¢«æ“ä½œçš„ç›®æ ‡å­—æ®µä¹‹é—´å»ºç«‹æ˜ç¡®çš„è”ç³»ã€‚å½“è¯»å–å±æ€§æ—¶ï¼Œæ— è®ºè¯»å–çš„æ˜¯å“ªä¸€ä¸ªå±æ€§ï¼Œå…¶å®éƒ½ä¸€æ ·ï¼Œéƒ½ä¼šæŠŠå‰¯ä½œç”¨å‡½æ•°æ”¶é›†åˆ°â€œæ¡¶â€é‡Œï¼›å½“ è®¾ç½®å±æ€§æ—¶ï¼Œæ— è®ºè®¾ç½®çš„æ˜¯å“ªä¸€ä¸ªå±æ€§ï¼Œä¹Ÿéƒ½ä¼šæŠŠâ€œæ¡¶â€é‡Œçš„å‰¯ä½œç”¨å‡½æ•°å–å‡ºå¹¶æ‰§è¡Œã€‚</p><p><strong>action</strong>ï¼šæ”¹å†™â€œæ¡¶â€çš„ç»“æ„</p></blockquote><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+k+`" alt="image-20230517192740314" tabindex="0" loading="lazy"><figcaption>image-20230517192740314</figcaption></figure><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// å­˜å‚¨å‰¯ä½œç”¨å‡½æ•°çš„æ¡¶</span>
<span class="token keyword">const</span> bucket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ‹¦æˆªè¯»å–æ“ä½œ</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ²¡æœ‰ activeEffectï¼Œç›´æ¥ return</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>activeEffect<span class="token punctuation">)</span> <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token comment">// æ ¹æ® target ä»â€œæ¡¶â€ä¸­å–å¾— depsMapï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ª Map ç±»å‹ï¼škey --&gt;effects</span>
        <span class="token keyword">let</span> depsMap <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
        <span class="token comment">// å¦‚æœä¸å­˜åœ¨ depsMapï¼Œé‚£ä¹ˆæ–°å»ºä¸€ä¸ª Map å¹¶ä¸ target å…³è”</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>depsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            bucket<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">(</span>depsMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å†æ ¹æ® key ä» depsMap ä¸­å–å¾— depsï¼Œå®ƒæ˜¯ä¸€ä¸ª Set ç±»å‹ï¼Œ</span>
        <span class="token comment">// é‡Œé¢å­˜å‚¨ç€æ‰€æœ‰ä¸å½“å‰ key ç›¸å…³è”çš„å‰¯ä½œç”¨å‡½æ•°ï¼šeffects</span>
        <span class="token keyword">let</span> deps <span class="token operator">=</span> depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token comment">// å¦‚æœ deps ä¸å­˜åœ¨ï¼ŒåŒæ ·æ–°å»ºä¸€ä¸ª Set å¹¶ä¸ key å…³è”</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>deps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            depsMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span>deps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æœ€åå°†å½“å‰æ¿€æ´»çš„å‰¯ä½œç”¨å‡½æ•°æ·»åŠ åˆ°â€œæ¡¶â€é‡Œ</span>
        deps<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>activeEffect<span class="token punctuation">)</span>

        <span class="token comment">// è¿”å›å±æ€§å€¼</span>
        <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// æ‹¦æˆªè®¾ç½®æ“ä½œ</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è®¾ç½®å±æ€§å€¼</span>
        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newVal
        <span class="token comment">// æ ¹æ® target ä»æ¡¶ä¸­å–å¾— depsMapï¼Œå®ƒæ˜¯ key --&gt; effects</span>
        <span class="token keyword">const</span> depsMap <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>depsMap<span class="token punctuation">)</span> <span class="token keyword">return</span>
        <span class="token comment">// æ ¹æ® key å–å¾—æ‰€æœ‰å‰¯ä½œç”¨å‡½æ•° effects</span>
        <span class="token keyword">const</span> effects <span class="token operator">=</span> depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token comment">// æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°</span>
        effects <span class="token operator">&amp;&amp;</span> effects<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>WeakMap å¯¹ key æ˜¯å¼±å¼•ç”¨ï¼Œä¸å½±å“åƒåœ¾å›æ”¶å™¨çš„å·¥ä½œã€‚å¦‚æœ target å¯¹è±¡æ²¡æœ‰ä»»ä½•å¼•ç”¨äº†ï¼Œè¯´æ˜ç”¨æˆ·ä¾§ä¸å†éœ€è¦å®ƒäº†ï¼Œ è¿™æ—¶åƒåœ¾å›æ”¶å™¨ä¼šå®Œæˆå›æ”¶ä»»åŠ¡ã€‚</li></ul><p>ä¸ºäº†æ–¹ä¾¿åç»­æ“ä½œï¼Œå°†å‰¯ä½œç”¨æ”¶é›†åˆ°â€œæ¡¶â€ä¸­çš„é€»è¾‘å’Œå–å‡ºæ‰§è¡Œçš„é€»è¾‘è¿›è¡Œå°è£…ï¼š</p><p><strong>å°†å‰¯ä½œç”¨å‡½æ•°æ”¶é›†åˆ°â€œæ¡¶â€é‡Œ</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨ get æ‹¦æˆªå‡½æ•°å†…è°ƒç”¨ track å‡½æ•°è¿½è¸ªå˜åŒ–</span>
<span class="token keyword">function</span> <span class="token function">track</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ²¡æœ‰ activeEffectï¼Œç›´æ¥ return</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>activeEffect<span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token keyword">let</span> depsMap <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>depsMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        bucket<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">(</span>depsMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> deps <span class="token operator">=</span> depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>deps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        depsMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span>deps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    deps<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>activeEffect<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è§¦å‘å‰¯ä½œç”¨å‡½æ•°é‡æ–°æ‰§è¡Œ</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// åœ¨ set æ‹¦æˆªå‡½æ•°å†…è°ƒç”¨ trigger å‡½æ•°è§¦å‘å˜åŒ–</span>
<span class="token keyword">function</span> <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> depsMap <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>depsMap<span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token keyword">const</span> effects <span class="token operator">=</span> depsMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">//ä¾èµ–é›†åˆ</span>
    effects <span class="token operator">&amp;&amp;</span> effects<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å¯¹è±¡çš„ä»£ç†æ“ä½œ</strong></p>`,12),w=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" obj "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Proxy"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// æ‹¦æˆªè¯»å–æ“ä½œ"),s(`
    `),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å°†å‰¯ä½œç”¨å‡½æ•° activeEffect æ·»åŠ åˆ°å­˜å‚¨å‰¯ä½œç”¨å‡½æ•°çš„æ¡¶ä¸­"),s(`
        `),n("span",{class:"token function"},"track"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token comment"},"// è¿”å›å±æ€§å€¼"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" target"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"// æ‹¦æˆªè®¾ç½®æ“ä½œ"),s(`
    `),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" newVal"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// è®¾ç½®å±æ€§å€¼"),s(`
        target`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(` newVal
        `),n("span",{class:"token comment"},"// æŠŠå‰¯ä½œç”¨å‡½æ•°ä»æ¡¶é‡Œå–å‡ºå¹¶æ‰§è¡Œ"),s(`
        `),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),j=a('<h4 id="cleanup" tabindex="-1"><a class="header-anchor" href="#cleanup"><span>cleanup</span></a></h4><blockquote><p><strong>é—®é¢˜</strong>ï¼šä»£ç åˆ†æ”¯å¯èƒ½ä¼šäº§ç”Ÿé—ç•™çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œå¯¼è‡´æ•°æ®ä¸å¿…è¦çš„æ›´æ–°ã€‚</p><p><strong>action</strong>ï¼šæ¯æ¬¡å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œæ—¶ï¼Œå…ˆæŠŠå®ƒä»æ‰€æœ‰ä¸ä¹‹å…³è”çš„ä¾èµ–é›†åˆä¸­åˆ é™¤ï¼ˆé‡æ–°æ”¶é›†å‰¯ä½œç”¨å‡½æ•°ä¸­ç”¨åˆ°çš„å“åº”å¼æ•°æ®ï¼‰</p></blockquote><p><code>document.body.innerText = obj.ok ? obj.text : &#39;not&#39;</code></p><p>å½“obj.okä¸ºtrueæ—¶çš„ç»“æ„å¦‚å›¾ï¼š</p><figure><img src="'+d+'" alt="image-20230517182210993" tabindex="0" loading="lazy"><figcaption>image-20230517182210993</figcaption></figure><p>å½“ä¿®æ”¹obj.okçš„å€¼ä¸ºfalseæ—¶ï¼Œç»“æ„ç†åº”å˜æˆï¼š</p><figure><img src="'+v+'" alt="image-20230517182421551" tabindex="0" loading="lazy"><figcaption>image-20230517182421551</figcaption></figure><p>ç„¶è€Œå¹¶æ²¡æœ‰ï¼Œå› ä¸ºè¿™ä¸ªâ€œæ¡¶â€å®ƒåªè¿›ä¸å‡ºï¼Œä¹‹å‰å­˜è¿›å»çš„å°±ä¸€ç›´å‘†åœ¨é‡Œé¢äº†ï¼Œæ‰€ä»¥ä»¥åå†ä¿®æ”¹obj.textçš„å€¼æ—¶ï¼Œä¾ç„¶ä¼šè§¦å‘å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œã€‚</p><p><mark>è¦çŸ¥é“å“ªäº›ä¾èµ–é›†åˆä¸­åŒ…å«è¿™ä¸ªå‰¯ä½œç”¨å‡½æ•°</mark></p><p><strong>ä¿®æ”¹å‰¯ä½œç”¨æ³¨å†Œå‡½æ•°</strong></p>',10),_=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// ç”¨ä¸€ä¸ªå…¨å±€å˜é‡å­˜å‚¨è¢«æ³¨å†Œçš„å‰¯ä½œç”¨å‡½æ•°"),s(`
`),n("span",{class:"token keyword"},"let"),s(` activeEffect
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"effectFn"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å½“ effectFn æ‰§è¡Œæ—¶ï¼Œå°†å…¶è®¾ç½®ä¸ºå½“å‰æ¿€æ´»çš„å‰¯ä½œç”¨å‡½æ•°"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(` effectFn
        `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token comment"},"// activeEffect.deps ç”¨æ¥å­˜å‚¨æ‰€æœ‰ä¸è¯¥å‰¯ä½œç”¨å‡½æ•°ç›¸å…³è”çš„ä¾èµ–é›†åˆ"),s(`
    effectFn`),n("span",{class:"token punctuation"},"."),s("deps "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token comment"},"// æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°"),s(`
    `),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),x=n("p",null,[n("strong",null,"trackå‡½æ•°")],-1),F=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"track"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("target"),n("span",{class:"token punctuation"},","),s(" key")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("activeEffect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" depsMap "),n("span",{class:"token operator"},"="),s(" bucket"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("depsMap"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        bucket`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),s("depsMap "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" deps "),n("span",{class:"token operator"},"="),s(" depsMap"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("deps"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        depsMap`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),s("deps "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    deps`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("activeEffect"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// deps å°±æ˜¯ä¸€ä¸ªä¸å½“å‰å‰¯ä½œç”¨å‡½æ•°å­˜åœ¨è”ç³»çš„ä¾èµ–é›†åˆ"),s(`
    `),n("span",{class:"token comment"},"// ç›¸å½“äºvue2ä¸­watcherå®ä¾‹çš„depsæ•°ç»„"),s(`
    `),n("span",{class:"token comment"},"// å°†å…¶æ·»åŠ åˆ° activeEffect.deps æ•°ç»„ä¸­"),s(`
    activeEffect`),n("span",{class:"token punctuation"},"."),s("deps"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("deps"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),M=n("p",null,[n("mark",null,"åœ¨æ¯æ¬¡å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œæ—¶ï¼Œå°†å‰¯ä½œç”¨å‡½æ•°ä»ä¾èµ–é›†åˆä¸­ç§»é™¤")],-1),E=n("p",null,[n("strong",null,"ä¿®æ”¹å‰¯ä½œç”¨æ³¨å†Œå‡½æ•°")],-1),q=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// ç”¨ä¸€ä¸ªå…¨å±€å˜é‡å­˜å‚¨è¢«æ³¨å†Œçš„å‰¯ä½œç”¨å‡½æ•°"),s(`
`),n("span",{class:"token keyword"},"let"),s(` activeEffect
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"effectFn"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// è°ƒç”¨ cleanup å‡½æ•°å®Œæˆæ¸…é™¤å·¥ä½œ"),s(`
        `),n("span",{class:"token function"},"cleanup"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(` effectFn
        `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    effectFn`),n("span",{class:"token punctuation"},"."),s("deps "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),V=a(`<p><strong>cleanup</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token parameter">effectFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// éå† effectFn.deps æ•°ç»„</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span>  <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> effectFn<span class="token punctuation">.</span>deps<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// deps æ˜¯ä¾èµ–é›†åˆ</span>
        <span class="token keyword">const</span> deps <span class="token operator">=</span> effectFn<span class="token punctuation">.</span>deps<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token comment">// å°† effectFn ä»ä¾èµ–é›†åˆä¸­ç§»é™¤</span>
        deps<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>effectFn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// æœ€åéœ€è¦é‡ç½® effectFn.deps æ•°ç»„</span>
    effectFn<span class="token punctuation">.</span>deps<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°†ä»£ç æŒ‰ä¸Šè¿°ä¿®æ”¹ä¹‹åä¼šäº§ç”Ÿæ— é™å¾ªç¯çš„é—®é¢˜ï¼Œé—®é¢˜å‡ºç°åœ¨Triggerå‡½æ•°ä¸­çš„å¾ªç¯ä¸­</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>effects <span class="token operator">&amp;&amp;</span> effects<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><mark>è§£å†³æ­»å¾ªç¯çš„é—®é¢˜</mark></p><p>å½“å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œæ—¶ï¼Œå…ˆè°ƒç”¨ <code>cleanup</code> è¿›è¡Œæ¸…é™¤ï¼Œç„¶åå‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œæ—¶åˆåŠ å›æ¥ï¼Œä¸€ä¸ªé›†åˆå·¦è¾¹åˆ å³è¾¹åŠ ï¼Œå¯¼è‡´å¾ªç¯ç»“æŸä¸äº†ï¼Œä¸ºæ­¤è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š</p><p><strong>trigger</strong></p>`,7),S=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("target"),n("span",{class:"token punctuation"},","),s(" key")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" depsMap "),n("span",{class:"token operator"},"="),s(" bucket"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("depsMap"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" effects "),n("span",{class:"token operator"},"="),s(" depsMap"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectsToRun "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),s("effects"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
    effectsToRun`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effectFn"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
    `),n("span",{class:"token comment"},"// effects && effects.forEach(effectFn => effectFn()) // åˆ é™¤"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),z=a(`<h4 id="ä½¿effectå¯åµŒå¥—" tabindex="-1"><a class="header-anchor" href="#ä½¿effectå¯åµŒå¥—"><span>ä½¿effectå¯åµŒå¥—</span></a></h4><blockquote><p><strong>é—®é¢˜</strong>ï¼šç»„ä»¶æ˜¯å¯ä»¥åµŒå¥—çš„ï¼Œè€Œç»„ä»¶çš„æ¸²æŸ“å‡½æ•°æ˜¯åœ¨effectä¸­æ‰§è¡Œçš„ï¼Œæ­¤æ—¶å°±å‘ç”Ÿäº†effectçš„åµŒå¥—ï¼Œä½†ç›®å‰çš„å“åº”ç³»ç»Ÿä¸æ”¯æŒåµŒå¥—ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Foo<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// åµŒå¥—</span>
    <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        Bar<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>action</strong>ï¼šå‡†å¤‡ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°æ ˆ</p></blockquote><p>ä¸æ”¯æŒåµŒå¥—çš„åŸå› æ˜¯ä½¿ç”¨å˜é‡activeEffectä¿å­˜å½“å‰çš„å‰¯ä½œç”¨å‡½æ•°ï¼ŒåŒæ—¶åªèƒ½å­˜åœ¨ä¸€ä¸ªï¼Œåæ¥çš„ä¼šè¦†ç›–å…ˆå‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°æ ˆ effectStackï¼Œ åœ¨å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œæ—¶ï¼Œå°†å½“å‰å‰¯ä½œç”¨å‡½æ•°å‹å…¥æ ˆä¸­ï¼Œå¾…å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åå°†å…¶ä»æ ˆä¸­å¼¹å‡ºï¼Œå¹¶å§‹ç»ˆè®© activeEffect æŒ‡å‘æ ˆé¡¶çš„å‰¯ä½œç”¨å‡½æ•°ã€‚</p>`,3),D=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// ç”¨ä¸€ä¸ªå…¨å±€å˜é‡å­˜å‚¨å½“å‰æ¿€æ´»çš„ effect å‡½æ•°"),s(`
`),n("span",{class:"token keyword"},"let"),s(` activeEffect
`),n("span",{class:"token comment"},"// effect æ ˆ"),s(`
`),n("span",{class:"token keyword"},"const"),s(" effectStack "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"effectFn"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"cleanup"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token comment"},"// å½“è°ƒç”¨ effect æ³¨å†Œå‰¯ä½œç”¨å‡½æ•°æ—¶ï¼Œå°†å‰¯ä½œç”¨å‡½æ•°èµ‹å€¼ç»™ activeEffect"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(` effectFn
        `),n("span",{class:"token comment"},"// åœ¨è°ƒç”¨å‰¯ä½œç”¨å‡½æ•°ä¹‹å‰å°†å½“å‰å‰¯ä½œç”¨å‡½æ•°å‹å…¥æ ˆä¸­"),s(`
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
        `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token comment"},"// åœ¨å½“å‰å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå°†å½“å‰å‰¯ä½œç”¨å‡½æ•°å¼¹å‡ºæ ˆï¼Œå¹¶æŠŠactiveEffect è¿˜åŸä¸ºä¹‹å‰çš„å€¼"),s(`
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"pop"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(" effectStack"),n("span",{class:"token punctuation"},"["),s("effectStack"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token comment"},"// activeEffect.deps ç”¨æ¥å­˜å‚¨æ‰€æœ‰ä¸è¯¥å‰¯ä½œç”¨å‡½æ•°ç›¸å…³çš„ä¾èµ–é›†åˆ"),s(`
    effectFn`),n("span",{class:"token punctuation"},"."),s("deps "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token comment"},"// æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°"),s(`
    `),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),B=n("figure",null,[n("img",{src:m,alt:"image-20230518153811983",tabindex:"0",loading:"lazy"}),n("figcaption",null,"image-20230518153811983")],-1),O=n("h4",{id:"è§£å†³è¯»å†™æ“ä½œä¸€èµ·æ—¶çš„æ— é™é€’å½’",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#è§£å†³è¯»å†™æ“ä½œä¸€èµ·æ—¶çš„æ— é™é€’å½’"},[n("span",null,"è§£å†³è¯»å†™æ“ä½œä¸€èµ·æ—¶çš„æ— é™é€’å½’")])],-1),T=n("blockquote",null,[n("p",null,[n("strong",null,"é—®é¢˜"),s("ï¼šç±»ä¼¼obj.foo++è¿™ç§æ“ä½œï¼Œæ—¢ä¼šè¯»å– obj.foo çš„å€¼ï¼Œåˆä¼šè®¾ç½® obj.foo çš„å€¼ã€‚è¯»å– obj.foo çš„å€¼ï¼Œä¼šè§¦å‘ track æ“ä½œï¼Œå°†å½“å‰å‰¯ä½œç”¨å‡½æ•°æ”¶é›†åˆ°â€œæ¡¶â€ä¸­ï¼Œæ¥ç€å°†å…¶åŠ  1 åå†èµ‹å€¼ç»™ obj.fooï¼Œæ­¤æ—¶ä¼šè§¦å‘ trigger æ“ä½œï¼Œå³æŠŠâ€œæ¡¶â€ä¸­çš„å‰¯ä½œç”¨å‡½æ•°å–å‡ºå¹¶æ‰§è¡Œã€‚ä½†é—®é¢˜æ˜¯è¯¥å‰¯ä½œç”¨å‡½æ•°æ­£åœ¨æ‰§è¡Œä¸­ï¼Œè¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œå°±è¦å¼€å§‹ä¸‹ä¸€æ¬¡çš„æ‰§ è¡Œã€‚è¿™æ ·ä¼šå¯¼è‡´æ— é™é€’å½’åœ°è°ƒç”¨è‡ªå·±ï¼Œäºæ˜¯å°±äº§ç”Ÿäº†æ ˆæº¢å‡ºã€‚")]),n("p",null,[n("strong",null,"action"),s("ï¼šå¦‚æœ trigger è§¦å‘æ‰§è¡Œçš„å‰¯ä½œç”¨å‡½æ•°ä¸å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‰¯ä½œç”¨å‡½æ•°ç›¸åŒï¼Œåˆ™ä¸è§¦å‘æ‰§è¡Œ")])],-1),C=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("target"),n("span",{class:"token punctuation"},","),s(" key")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" depsMap "),n("span",{class:"token operator"},"="),s(" bucket"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("depsMap"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" effects "),n("span",{class:"token operator"},"="),s(" depsMap"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectsToRun "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    effects `),n("span",{class:"token operator"},"&&"),s(" effects"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effectFn"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å¦‚æœ trigger è§¦å‘æ‰§è¡Œçš„å‰¯ä½œç”¨å‡½æ•°ä¸å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‰¯ä½œç”¨å‡½æ•°ç›¸åŒï¼Œåˆ™ä¸è§¦å‘æ‰§è¡Œ"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("effectFn "),n("span",{class:"token operator"},"!=="),s(" activeEffect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
            effectsToRun`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    effectsToRun`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effectFn"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// effects && effects.forEach(effectFn => effectFn())"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),I=n("h4",{id:"å®Œæˆå¯è°ƒåº¦æ€§",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#å®Œæˆå¯è°ƒåº¦æ€§"},[n("span",null,"å®Œæˆå¯è°ƒåº¦æ€§")])],-1),P=n("blockquote",null,[n("p",null,[n("strong",null,"é—®é¢˜"),s("ï¼šæˆ‘ä»¬éœ€è¦åœ¨triggerè§¦å‘å‰¯ä½œç”¨å‡½æ•°é‡æ–°æ‰§è¡Œæ—¶æœ‰èƒ½åŠ›å†³å®šå‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œçš„æ—¶æœºã€æ¬¡æ•°ä»¥åŠæ–¹å¼ã€‚")]),n("p",null,[n("strong",null,"action"),s("ï¼šä¸ºå‰¯ä½œç”¨å‡½æ•°æ·»åŠ è°ƒåº¦å‡½æ•°")])],-1),R=n("p",null,[n("strong",null,"æ‹“å±•effectå‡½æ•°")],-1),N=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("fn"),n("span",{class:"token punctuation"},","),s(" options "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"effectFn"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"cleanup"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token comment"},"// å½“è°ƒç”¨ effect æ³¨å†Œå‰¯ä½œç”¨å‡½æ•°æ—¶ï¼Œå°†å‰¯ä½œç”¨å‡½æ•°èµ‹å€¼ç»™ activeEffect"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(` effectFn
        `),n("span",{class:"token comment"},"// åœ¨è°ƒç”¨å‰¯ä½œç”¨å‡½æ•°ä¹‹å‰å°†å½“å‰å‰¯ä½œç”¨å‡½æ•°å‹æ ˆ"),s(`
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token comment"},"// åœ¨å½“å‰å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå°†å½“å‰å‰¯ä½œç”¨å‡½æ•°å¼¹å‡ºæ ˆï¼Œå¹¶æŠŠactiveEffect è¿˜åŸä¸ºä¹‹å‰çš„å€¼"),s(`
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"pop"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(" effectStack"),n("span",{class:"token punctuation"},"["),s("effectStack"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token comment"},"// å°† options æŒ‚è½½åˆ° effectFn ä¸Š"),s(`
    effectFn`),n("span",{class:"token punctuation"},"."),s("options "),n("span",{class:"token operator"},"="),s(" options "),n("span",{class:"token comment"},"// æ–°å¢"),s(`
    `),n("span",{class:"token comment"},"// activeEffect.deps ç”¨æ¥å­˜å‚¨æ‰€æœ‰ä¸è¯¥å‰¯ä½œç”¨å‡½æ•°ç›¸å…³çš„ä¾èµ–é›†åˆ"),s(`
    effectFn`),n("span",{class:"token punctuation"},"."),s("deps "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token comment"},"// æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°"),s(`
    `),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),A=n("p",null,[n("strong",null,"triggerå‡½æ•°")],-1),W=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("target"),n("span",{class:"token punctuation"},","),s(" key")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" depsMap "),n("span",{class:"token operator"},"="),s(" bucket"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("target"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("depsMap"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" effects "),n("span",{class:"token operator"},"="),s(" depsMap"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectsToRun "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    effects `),n("span",{class:"token operator"},"&&"),s(" effects"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effectFn"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("effectFn "),n("span",{class:"token operator"},"!=="),s(" activeEffect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            effectsToRun`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    effectsToRun`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effectFn"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å¦‚æœä¸€ä¸ªå‰¯ä½œç”¨å‡½æ•°å­˜åœ¨è°ƒåº¦å™¨ï¼Œåˆ™è°ƒç”¨è¯¥è°ƒåº¦å™¨ï¼Œå¹¶å°†å‰¯ä½œç”¨å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},"."),s("options"),n("span",{class:"token punctuation"},"."),s("scheduler"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
            effectFn`),n("span",{class:"token punctuation"},"."),s("options"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"scheduler"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token comment"},"// å¦åˆ™ç›´æ¥æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°ï¼ˆä¹‹å‰çš„é»˜è®¤è¡Œä¸ºï¼‰"),s(`
            `),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Z=a(`<p><strong>ä½¿ç”¨æ—¶</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">effect</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// options</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// è°ƒåº¦å™¨ scheduler æ˜¯ä¸€ä¸ªå‡½æ•°</span>
        <span class="token function">scheduler</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å°†å‰¯ä½œç”¨å‡½æ•°æ”¾åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰§è¡Œ</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å‰¯ä½œç”¨å‡½æ•°çš„æ‡’åŠ è½½" tabindex="-1"><a class="header-anchor" href="#å‰¯ä½œç”¨å‡½æ•°çš„æ‡’åŠ è½½"><span>å‰¯ä½œç”¨å‡½æ•°çš„æ‡’åŠ è½½</span></a></h4><blockquote><p><strong>é—®é¢˜</strong>ï¼šåœ¨æœ‰äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›å‰¯ä½œç”¨å‡½æ•°ç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯å¸Œæœ›å®ƒåœ¨éœ€è¦çš„æ—¶å€™æ‰æ‰§è¡Œï¼Œä¾‹å¦‚è®¡ç®—å±æ€§ã€‚</p><p><strong>action</strong>ï¼šåœ¨ options ä¸­æ·»åŠ  lazy å±æ€§</p></blockquote><p><strong>ä½¿ç”¨æ—¶</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">effect</span><span class="token punctuation">(</span>
    <span class="token comment">// æŒ‡å®šäº† lazy é€‰é¡¹ï¼Œè¿™ä¸ªå‡½æ•°ä¸ä¼šç«‹å³æ‰§è¡Œ</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// options</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">lazy</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>effectå‡½æ•°</strong></p>`,7),L=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("fn"),n("span",{class:"token punctuation"},","),s(" options "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"effectFn"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"cleanup"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(` effectFn
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"pop"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(" effectStack"),n("span",{class:"token punctuation"},"["),s("effectStack"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    effectFn`),n("span",{class:"token punctuation"},"."),s("options "),n("span",{class:"token operator"},"="),s(` options
    effectFn`),n("span",{class:"token punctuation"},"."),s("deps "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token comment"},"// åªæœ‰é lazy çš„æ—¶å€™ï¼Œæ‰æ‰§è¡Œ"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("options"),n("span",{class:"token punctuation"},"."),s("lazy"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
        `),n("span",{class:"token comment"},"// æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°"),s(`
        `),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token comment"},"// å°†å‰¯ä½œç”¨å‡½æ•°ä½œä¸ºè¿”å›å€¼è¿”å›"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" effectFn "),n("span",{class:"token comment"},"// æ–°å¢"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),U=n("ul",null,[n("li",null,"é€šè¿‡è¿”å›å€¼èƒ½å¤Ÿæ‹¿åˆ°å¯¹åº”çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ‰‹åŠ¨æ‰§è¡Œè¯¥å‰¯ä½œç”¨å‡½æ•°")],-1),H=n("h4",{id:"getterçš„å®ç°",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#getterçš„å®ç°"},[n("span",null,"getterçš„å®ç°")])],-1),J=n("blockquote",null,[n("p",null,[n("strong",null,"é—®é¢˜"),s("ï¼šèƒ½å¤Ÿæ‰‹åŠ¨æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°ï¼Œä½œç”¨å¹¶ä¸å¤§ï¼Œæˆ‘ä»¬æƒ³è¦æ‹¿åˆ°å‰¯ä½œç”¨å‡½æ•°ï¼ˆgetterï¼‰çš„è¿”å›å€¼")]),n("p",null,[n("strong",null,"action"),s("ï¼šå‰¯ä½œç”¨å‡½æ•°ä¸­æ·»åŠ å˜é‡ä¿å­˜fnçš„å€¼")])],-1),X=n("p",null,[n("strong",null,"effectå‡½æ•°")],-1),Y=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("fn"),n("span",{class:"token punctuation"},","),s(" options "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"effectFn"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"cleanup"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(` effectFn
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("effectFn"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token comment"},"// å°† fn çš„æ‰§è¡Œç»“æœå­˜å‚¨åˆ° res ä¸­"),s(`
        `),n("span",{class:"token keyword"},"const"),s(" res "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// æ–°å¢"),s(`
        effectStack`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"pop"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        activeEffect `),n("span",{class:"token operator"},"="),s(" effectStack"),n("span",{class:"token punctuation"},"["),s("effectStack"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token punctuation"},"]"),s(`
        `),n("span",{class:"token comment"},"// å°† res ä½œä¸º effectFn çš„è¿”å›å€¼"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" res "),n("span",{class:"token comment"},"// æ–°å¢"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    effectFn`),n("span",{class:"token punctuation"},"."),s("options "),n("span",{class:"token operator"},"="),s(` options
    effectFn`),n("span",{class:"token punctuation"},"."),s("deps "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("options"),n("span",{class:"token punctuation"},"."),s("lazy"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"return"),s(` effectFn
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Q=a(`<h3 id="_4-è®¡ç®—å±æ€§computedçš„å®ç°" tabindex="-1"><a class="header-anchor" href="#_4-è®¡ç®—å±æ€§computedçš„å®ç°"><span>4. è®¡ç®—å±æ€§computedçš„å®ç°</span></a></h3><blockquote><p>å€ŸåŠ©ä¸Šè¿°å‡½æ•°å®Œæˆçš„åŸºæœ¬æ¡†æ¶</p></blockquote><p><strong>computedå‡½æ•°</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token parameter">getter</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŠŠ getter ä½œä¸ºå‰¯ä½œç”¨å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ª lazy çš„ effect</span>
    <span class="token keyword">const</span> effectFn <span class="token operator">=</span> <span class="token function">effect</span><span class="token punctuation">(</span>getter<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">lazy</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment">// å½“è¯»å– value æ—¶æ‰æ‰§è¡Œ effectFn</span>
        <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">effectFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token number">2</span>  <span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> sumRes <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>foo <span class="token operator">+</span> obj<span class="token punctuation">.</span>bar<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sumRes<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">//  3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åªæœ‰çœŸæ­£è¯»å– <code>sumRes.value</code> çš„å€¼æ—¶ï¼Œ å®ƒæ‰ä¼šè¿›è¡Œè®¡ç®—å¹¶å¾—åˆ°å€¼</li></ul><blockquote><p>æ·»åŠ ç¼“å­˜åŠŸèƒ½</p></blockquote><p><strong>computedå‡½æ•°</strong></p>`,9),G=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"computed"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"getter"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// value ç”¨æ¥ç¼“å­˜ä¸Šä¸€æ¬¡è®¡ç®—çš„å€¼"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` value
    `),n("span",{class:"token comment"},"// dirty æ ‡å¿—ï¼Œç”¨æ¥æ ‡è¯†æ˜¯å¦éœ€è¦é‡æ–°è®¡ç®—å€¼ï¼Œä¸º true åˆ™æ„å‘³ç€â€œè„â€ï¼Œéœ€è¦è®¡ç®—"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" dirty "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"true"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectFn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s("getter"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token literal-property property"},"lazy"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" obj "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"get"),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token comment"},"// åªæœ‰â€œè„â€æ—¶æ‰è®¡ç®—å€¼ï¼Œå¹¶å°†å¾—åˆ°çš„å€¼ç¼“å­˜åˆ° value ä¸­"),s(`
            `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("dirty"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                value `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token comment"},"// å°† dirty è®¾ç½®ä¸º falseï¼Œä¸‹ä¸€æ¬¡è®¿é—®ç›´æ¥ä½¿ç”¨ç¼“å­˜åˆ° value ä¸­çš„å€¼"),s(`
                dirty `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"false"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
            `),n("span",{class:"token keyword"},"return"),s(` value
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"return"),s(` obj
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),K=n("p",null,"è¿™æ—¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯è¯»å–valueæ—¶dirtyè¢«æ”¹æˆfalseï¼Œç„¶åå˜ä¸å›æ¥äº†ï¼Œä»¥åä¸€ç›´è®¿é—®çš„ç¼“å­˜å€¼ï¼Œä¸ºæ­¤åˆ©ç”¨ä¹‹å‰å®ç°çš„è°ƒåº¦å™¨åšå‡ºå¦‚ä¸‹ä¿®æ”¹ï¼š",-1),$=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"computed"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"getter"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` value
    `),n("span",{class:"token keyword"},"let"),s(" dirty "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"true"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectFn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s("getter"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token literal-property property"},"lazy"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token comment"},"// æ·»åŠ è°ƒåº¦å™¨ï¼Œåœ¨è°ƒåº¦å™¨ä¸­å°† dirty é‡ç½®ä¸º true"),s(`
        `),n("span",{class:"token function"},"scheduler"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            dirty `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"true"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" obj "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"get"),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("dirty"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                value `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                dirty `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"false"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
            `),n("span",{class:"token keyword"},"return"),s(` value
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"return"),s(` obj
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),nn=n("blockquote",null,[n("p",null,[n("strong",null,"é—®é¢˜"),s("ï¼šåœ¨å¦ä¸€ä¸ªeffectä¸­è¯»å–è®¡ç®—å±æ€§çš„å€¼æ—¶ï¼Œè®¡ç®—å±æ€§å†…å±æ€§å€¼çš„å˜åŒ–ä¸ä¼šè§¦å‘å‰¯ä½œç”¨å‡½æ•°çš„é‡æ–°æ¸²æŸ“")]),n("p",null,[n("strong",null,"action"),s("ï¼šå½“è¯»å–è®¡ç®—å±æ€§çš„å€¼æ—¶ï¼Œæ‰‹åŠ¨è°ƒç”¨ track å‡½æ•°è¿›è¡Œè¿½è¸ªï¼›å½“è®¡ç®—å±æ€§ä¾èµ–çš„å“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰‹åŠ¨è°ƒç”¨ trigger å‡½æ•°è§¦å‘å“åº”")])],-1),sn=n("p",null,[n("strong",null,"computeå‡½æ•°")],-1),an=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"computed"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"getter"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` value
    `),n("span",{class:"token keyword"},"let"),s(" dirty "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"true"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectFn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s("getter"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token literal-property property"},"lazy"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token function"},"scheduler"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("dirty"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                dirty `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"true"),s(`
                `),n("span",{class:"token comment"},"// å½“è®¡ç®—å±æ€§ä¾èµ–çš„å“åº”å¼æ•°æ®å˜åŒ–æ—¶ï¼Œæ‰‹åŠ¨è°ƒç”¨ trigger å‡½æ•°è§¦å‘å“åº”"),s(`
                `),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),s("obj"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'value'"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" obj "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"get"),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("dirty"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                value `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                dirty `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"false"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
            `),n("span",{class:"token comment"},"// å½“è¯»å– value æ—¶ï¼Œæ‰‹åŠ¨è°ƒç”¨ track å‡½æ•°è¿›è¡Œè¿½è¸ª"),s(`
            `),n("span",{class:"token function"},"track"),n("span",{class:"token punctuation"},"("),s("obj"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'value'"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token keyword"},"return"),s(` value
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"return"),s(` obj
`),n("span",{class:"token punctuation"},"}"),s(`

`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),tn=a(`<h3 id="_5-watchçš„å®ç°" tabindex="-1"><a class="header-anchor" href="#_5-watchçš„å®ç°"><span>5. watchçš„å®ç°</span></a></h3><p>æ‰€è°“ watchï¼Œå…¶æœ¬è´¨å°±æ˜¯è§‚æµ‹ä¸€ä¸ªå“åº”å¼æ•°æ®ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥å¹¶æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚<mark>watch çš„å®ç°æœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨äº†effect ä»¥åŠ options.scheduler é€‰é¡¹</mark></p><blockquote><p>ç®€å•å®ç°</p></blockquote><p><strong>watchå‡½æ•°</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// watch å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œsource æ˜¯å“åº”å¼æ•°æ®ï¼Œcb æ˜¯å›è°ƒå‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">watch</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">effect</span><span class="token punctuation">(</span>
        <span class="token comment">// è§¦å‘è¯»å–æ“ä½œï¼Œä»è€Œå»ºç«‹è”ç³»</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> source<span class="token punctuation">.</span>foo<span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token function">scheduler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// å½“æ•°æ®å˜åŒ–æ—¶ï¼Œè°ƒç”¨å›è°ƒå‡½æ•° cb</span>
                <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä½¿ç”¨æ—¶</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span>  <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">watch</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ•°æ®å˜åŒ–äº†&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

obj<span class="token punctuation">.</span>foo<span class="token operator">++</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>è§£å†³source.fooçš„ç¡¬ç¼–ç é—®é¢˜</p></blockquote><p><strong>watchå‡½æ•°</strong></p>`,9),en=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"watch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("source"),n("span",{class:"token punctuation"},","),s(" cb")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token comment"},"// è°ƒç”¨ traverse é€’å½’åœ°è¯»å–"),s(`
        `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"traverse"),n("span",{class:"token punctuation"},"("),s("source"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token function"},"scheduler"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token comment"},"// å½“æ•°æ®å˜åŒ–æ—¶ï¼Œè°ƒç”¨å›è°ƒå‡½æ•° cb"),s(`
                `),n("span",{class:"token function"},"cb"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),cn=a(`<p><strong>traverseå‡½æ•°</strong>ï¼ˆé€šç”¨çš„è¯»å–æ“ä½œï¼‰</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">traverse</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> seen <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœè¦è¯»å–çš„æ•°æ®æ˜¯åŸå§‹å€¼ï¼Œæˆ–è€…å·²ç»è¢«è¯»å–è¿‡äº†ï¼Œé‚£ä¹ˆä»€ä¹ˆéƒ½ä¸åš</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">!==</span> <span class="token string">&#39;object&#39;</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> seen<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token comment">// å°†æ•°æ®æ·»åŠ åˆ° seen ä¸­ï¼Œä»£è¡¨éå†åœ°è¯»å–è¿‡äº†ï¼Œé¿å…å¾ªç¯å¼•ç”¨å¼•èµ·çš„æ­»å¾ªç¯</span>
    seen<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token comment">// æš‚æ—¶ä¸è€ƒè™‘æ•°ç»„ç­‰å…¶ä»–ç»“æ„</span>
    <span class="token comment">// å‡è®¾ value å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½¿ç”¨ for...in è¯»å–å¯¹è±¡çš„æ¯ä¸€ä¸ªå€¼ï¼Œå¹¶é€’å½’åœ°è°ƒç”¨ traverse è¿›è¡Œå¤„ç†</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> k <span class="token keyword">in</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">traverse</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span> seen<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å®ç°å¯ç›‘æµ‹getterå‡½æ•°</p></blockquote><p><strong>watchå‡½æ•°</strong></p>`,4),on=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"watch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("source"),n("span",{class:"token punctuation"},","),s(" cb")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// å®šä¹‰ getter"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` getter
    `),n("span",{class:"token comment"},"// å¦‚æœ source æ˜¯å‡½æ•°ï¼Œè¯´æ˜ç”¨æˆ·ä¼ é€’çš„æ˜¯ getterï¼Œæ‰€ä»¥ç›´æ¥æŠŠ source èµ‹å€¼ç»™ getter"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" source "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'function'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        getter `),n("span",{class:"token operator"},"="),s(` source
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å¦åˆ™æŒ‰ç…§åŸæ¥çš„å®ç°è°ƒç”¨ traverse é€’å½’åœ°è¯»å–"),s(`
        `),n("span",{class:"token function-variable function"},"getter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"traverse"),n("span",{class:"token punctuation"},"("),s("source"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token comment"},"// æ‰§è¡Œ getter"),s(`
        `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"getter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token function"},"scheduler"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token function"},"cb"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),pn=n("blockquote",null,[n("p",null,"å®ç°åœ¨watchå›è°ƒå‡½æ•°ä¸­æ‹¿åˆ°æ–°æ—§å€¼")],-1),ln=n("p",null,[n("mark",null,"åˆ©ç”¨ effect å‡½æ•°çš„ lazy é€‰é¡¹")],-1),un=n("p",null,[n("strong",null,"watchå‡½æ•°")],-1),rn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"watch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("source"),n("span",{class:"token punctuation"},","),s(" cb")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` getter
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" source "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'function'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        getter `),n("span",{class:"token operator"},"="),s(` source
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function-variable function"},"getter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"traverse"),n("span",{class:"token punctuation"},"("),s("source"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token comment"},"// å®šä¹‰æ—§å€¼ä¸æ–°å€¼"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" oldValue"),n("span",{class:"token punctuation"},","),s(` newValue
    `),n("span",{class:"token comment"},"// ä½¿ç”¨ effect æ³¨å†Œå‰¯ä½œç”¨å‡½æ•°æ—¶ï¼Œå¼€å¯ lazy é€‰é¡¹ï¼Œå¹¶æŠŠè¿”å›å€¼å­˜å‚¨åˆ°effectFn ä¸­ä»¥ä¾¿åç»­æ‰‹åŠ¨è°ƒç”¨"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" effectFn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"getter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token literal-property property"},"lazy"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token function"},"scheduler"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token comment"},"// åœ¨ scheduler ä¸­é‡æ–°æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°ï¼Œå¾—åˆ°çš„æ˜¯æ–°å€¼"),s(`
                newValue `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token comment"},"// å°†æ—§å€¼å’Œæ–°å€¼ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°"),s(`
                `),n("span",{class:"token function"},"cb"),n("span",{class:"token punctuation"},"("),s("newValue"),n("span",{class:"token punctuation"},","),s(" oldValue"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token comment"},"// æ›´æ–°æ—§å€¼ï¼Œä¸ç„¶ä¸‹ä¸€æ¬¡ä¼šå¾—åˆ°é”™è¯¯çš„æ—§å€¼"),s(`
                oldValue `),n("span",{class:"token operator"},"="),s(` newValue
            `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// æ‰‹åŠ¨è°ƒç”¨å‰¯ä½œç”¨å‡½æ•°ï¼Œæ‹¿åˆ°çš„å€¼å°±æ˜¯æ—§å€¼"),s(`
    oldValue `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),kn=n("blockquote",null,[n("p",null,"è®¾ç½®immediateä¸ºtrueæ¥ä½¿å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œä¸€æ¬¡;"),n("p",null,"è®¾ç½®flushæŒ‡å®šå›è°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœº")],-1),dn=n("p",null,[n("strong",null,"watchå‡½æ•°")],-1),vn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"watch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("source"),n("span",{class:"token punctuation"},","),s(" cb"),n("span",{class:"token punctuation"},","),s(" options "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` getter
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" source "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'function'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        getter `),n("span",{class:"token operator"},"="),s(` source
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function-variable function"},"getter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"traverse"),n("span",{class:"token punctuation"},"("),s("source"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"let"),s(" oldValue"),n("span",{class:"token punctuation"},","),s(` newValue

    `),n("span",{class:"token comment"},"// æå– scheduler è°ƒåº¦å‡½æ•°ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ job å‡½æ•°"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"job"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        newValue `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token function"},"cb"),n("span",{class:"token punctuation"},"("),s("newValue"),n("span",{class:"token punctuation"},","),s(" oldValue"),n("span",{class:"token punctuation"},")"),s(`
        oldValue `),n("span",{class:"token operator"},"="),s(` newValue
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectFn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token comment"},"// æ‰§è¡Œ getter"),s(`
        `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"getter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token literal-property property"},"lazy"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token comment"},"// ä½¿ç”¨ job å‡½æ•°ä½œä¸ºè°ƒåº¦å™¨å‡½æ•°"),s(`
            `),n("span",{class:"token function-variable function"},"scheduler"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token comment"},"// åœ¨è°ƒåº¦å‡½æ•°ä¸­åˆ¤æ–­ flush æ˜¯å¦ä¸º 'post'ï¼Œå¦‚æœæ˜¯ï¼Œå°†å…¶æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰§è¡Œ"),s(`
                `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("options"),n("span",{class:"token punctuation"},"."),s("flush "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'post'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                    `),n("span",{class:"token keyword"},"const"),s(" p "),n("span",{class:"token operator"},"="),s(" Promise"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                    p`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),s("job"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
                    `),n("span",{class:"token function"},"job"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("options"),n("span",{class:"token punctuation"},"."),s("immediate"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å½“ immediate ä¸º true æ—¶ç«‹å³æ‰§è¡Œ jobï¼Œä»è€Œè§¦å‘å›è°ƒæ‰§è¡Œ"),s(`
        `),n("span",{class:"token function"},"job"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        oldValue `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),mn=a('<blockquote><p>è§£å†³ç«æ€é—®é¢˜ï¼ˆéœ€è¦ä¸€ç§ä½¿å‰¯ä½œç”¨è¿‡æœŸçš„æ‰‹æ®µï¼‰</p></blockquote><figure><img src="'+b+`" alt="image-20230519093732138" tabindex="0" loading="lazy"><figcaption>image-20230519093732138</figcaption></figure><p>è¯·æ±‚ A æ˜¯å‰¯ä½œç”¨å‡½æ•°ç¬¬ä¸€æ¬¡æ‰§è¡Œæ‰€äº§ç”Ÿçš„å‰¯ä½œç”¨ï¼Œè¯·æ±‚ B æ˜¯å‰¯ä½œç”¨å‡½æ•°ç¬¬äºŒæ¬¡æ‰§è¡Œæ‰€äº§ ç”Ÿçš„å‰¯ä½œç”¨ã€‚ç”±äºè¯·æ±‚ B åå‘ç”Ÿï¼Œæ‰€ä»¥è¯·æ±‚ B çš„ç»“æœåº”è¯¥è¢«è§†ä¸ºâ€œæœ€ æ–°â€çš„ï¼Œè€Œè¯·æ±‚ A å·²ç»â€œè¿‡æœŸâ€äº†ï¼Œå…¶äº§ç”Ÿçš„ç»“æœåº”è¢«è§†ä¸ºæ— æ•ˆã€‚</p><p>watch å‡½æ•°çš„å›è°ƒå‡½æ•°æ¥æ”¶ç¬¬ä¸‰ä¸ªå‚æ•° <code>onInvalidate</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç±»ä¼¼äºäº‹ä»¶ç›‘å¬å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>onInvalidate</code> å‡½æ•°æ³¨å†Œä¸€ä¸ªå›è°ƒï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šåœ¨å½“å‰å‰¯ä½œç”¨å‡½æ•°è¿‡æœŸæ—¶æ‰§è¡Œï¼š</p><p><strong>ä½¿ç”¨æ—¶</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token function">watch</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> onInvalidate</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å®šä¹‰ä¸€ä¸ªæ ‡å¿—ï¼Œä»£è¡¨å½“å‰å‰¯ä½œç”¨å‡½æ•°æ˜¯å¦è¿‡æœŸï¼Œé»˜è®¤ä¸º falseï¼Œä»£è¡¨æ²¡æœ‰è¿‡æœŸ</span>
    <span class="token keyword">let</span> expired <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token comment">// è°ƒç”¨ onInvalidate() å‡½æ•°æ³¨å†Œä¸€ä¸ªè¿‡æœŸå›è°ƒ</span>
    <span class="token function">onInvalidate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// å½“è¿‡æœŸæ—¶ï¼Œå°† expired è®¾ç½®ä¸º true</span>
        expired <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// å‘é€ç½‘ç»œè¯·æ±‚</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/path/to/request&#39;</span><span class="token punctuation">)</span>

    <span class="token comment">// åªæœ‰å½“è¯¥å‰¯ä½œç”¨å‡½æ•°çš„æ‰§è¡Œæ²¡æœ‰è¿‡æœŸæ—¶ï¼Œæ‰ä¼šæ‰§è¡Œåç»­æ“ä½œã€‚</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>expired<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        finalData <span class="token operator">=</span> res
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>watchå‡½æ•°</strong></p>`,7),bn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{js:"",class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"watch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("source"),n("span",{class:"token punctuation"},","),s(" cb"),n("span",{class:"token punctuation"},","),s(" options "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` getter
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" source "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'function'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        getter `),n("span",{class:"token operator"},"="),s(` source
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function-variable function"},"getter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"traverse"),n("span",{class:"token punctuation"},"("),s("source"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"let"),s(" oldValue"),n("span",{class:"token punctuation"},","),s(` newValue

    `),n("span",{class:"token comment"},"// cleanup ç”¨æ¥å­˜å‚¨ç”¨æˆ·æ³¨å†Œçš„è¿‡æœŸå›è°ƒ"),s(`
    `),n("span",{class:"token keyword"},"let"),s(` cleanup
    `),n("span",{class:"token comment"},"// å®šä¹‰ onInvalidate å‡½æ•°"),s(`
    `),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"onInvalidate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// å°†è¿‡æœŸå›è°ƒå­˜å‚¨åˆ° cleanup ä¸­"),s(`
        cleanup `),n("span",{class:"token operator"},"="),s(` fn
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"job"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        newValue `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token comment"},"// åœ¨è°ƒç”¨å›è°ƒå‡½æ•° cb ä¹‹å‰ï¼Œå…ˆè°ƒç”¨è¿‡æœŸå›è°ƒ"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("cleanup"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token function"},"cleanup"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token comment"},"// å°† onInvalidate ä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä»¥ä¾¿ç”¨æˆ·ä½¿ç”¨"),s(`
        `),n("span",{class:"token function"},"cb"),n("span",{class:"token punctuation"},"("),s("newValue"),n("span",{class:"token punctuation"},","),s(" oldValue"),n("span",{class:"token punctuation"},","),s(" onInvalidate"),n("span",{class:"token punctuation"},")"),s(`
        oldValue `),n("span",{class:"token operator"},"="),s(` newValue
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" effectFn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token comment"},"// æ‰§è¡Œ getter"),s(`
        `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"getter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token literal-property property"},"lazy"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token function-variable function"},"scheduler"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("options"),n("span",{class:"token punctuation"},"."),s("flush "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'post'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                    `),n("span",{class:"token keyword"},"const"),s(" p "),n("span",{class:"token operator"},"="),s(" Promise"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                    p`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),s("job"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
                    `),n("span",{class:"token function"},"job"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("options"),n("span",{class:"token punctuation"},"."),s("immediate"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"job"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        oldValue `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"effectFn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("div",{class:"highlight-line"},"Â "),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),fn=n("ul",null,[n("li",null,[n("code",null,"onInvalidate"),s("çš„è¿‡æœŸå›è°ƒåœ¨"),n("code",null,"watch"),s("å›è°ƒæ‰§è¡Œæ—¶æ³¨å†Œï¼Œè€Œè¿‡æœŸå›è°ƒæ˜¯åœ¨"),n("code",null,"watch"),s("å›è°ƒæ‰§è¡Œå‰è¿è¡Œçš„ï¼Œæ‰€ä»¥å½“å±æ€§ä¿®æ”¹è§¦å‘å›è°ƒæ‰§è¡Œåæ‰æ³¨å†Œäº†è¿‡æœŸå›è°ƒï¼Œå½“å†æ¬¡ä¿®æ”¹å±æ€§å€¼æ—¶ï¼Œè¿‡æœŸå›è°ƒå­˜åœ¨ä¼˜å…ˆæ‰§è¡Œï¼Œå°†ä¹‹å‰å›è°ƒè¿”å›çš„æ•°æ®æŠ›å¼ƒã€‚")])],-1),gn=[g,h,y,w,j,_,x,F,M,E,q,V,S,z,D,B,O,T,C,I,P,R,N,A,W,Z,L,U,H,J,X,Y,Q,G,K,$,nn,sn,an,tn,en,cn,on,pn,ln,un,rn,kn,dn,vn,mn,bn,fn];function hn(yn,wn){return e(),c("div",null,gn)}const xn=t(f,[["render",hn],["__file","vuejs1-4.html.vue"]]),Fn=JSON.parse(`{"path":"/source_code/vue3/vuejs1-4.html","title":"vueçš„è®¾è®¡ä¸å®ç°ï¼ˆ1-4ç« ï¼‰","lang":"zh-CN","frontmatter":{"description":"vueçš„è®¾è®¡ä¸å®ç°ï¼ˆ1-4ç« ï¼‰ éœæ˜¥é˜³ã€ŠVue.jsè®¾è®¡ä¸å®ç°ã€‹çš„ç¬”è®° ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©ï¼ˆæƒè¡¡ï¼‰ 1. å£°æ˜å¼orå‘½ä»¤å¼ å‘½ä»¤å¼ï¼ˆå…³æ³¨è¿‡ç¨‹ï¼‰ å£°æ˜å¼ï¼ˆå…³æ³¨ç»“æœï¼‰ è¿™éƒ¨åˆ†çš„é€‰æ‹©ä¸»è¦åŸºäºä¸¤ä¸ªæ–¹é¢ï¼šæ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚ å› ä¸ºå£°æ˜å¼åœ¨å‘½ä»¤å¼æ€§èƒ½æ¶ˆè€—çš„åŸºç¡€ä¸Šå¤šå‡ºäº†diffçš„æ€§èƒ½æ¶ˆè€—ï¼Œæ‰€ä»¥åœ¨æ€§èƒ½ä¸Šä¼šå·®ä¸€äº› ä½†éšä¹‹å¸¦æ¥çš„æ˜¯å¯ç»´æŠ¤æ€§çš„å·¨å¤§æå‡ Vueå°è£…å‘½ä»¤å¼çš„ä»£...","head":[["meta",{"property":"og:url","content":"https://dcbestwords.gitee.io/dcBlog/source_code/vue3/vuejs1-4.html"}],["meta",{"property":"og:site_name","content":"dcBlog"}],["meta",{"property":"og:title","content":"vueçš„è®¾è®¡ä¸å®ç°ï¼ˆ1-4ç« ï¼‰"}],["meta",{"property":"og:description","content":"vueçš„è®¾è®¡ä¸å®ç°ï¼ˆ1-4ç« ï¼‰ éœæ˜¥é˜³ã€ŠVue.jsè®¾è®¡ä¸å®ç°ã€‹çš„ç¬”è®° ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©ï¼ˆæƒè¡¡ï¼‰ 1. å£°æ˜å¼orå‘½ä»¤å¼ å‘½ä»¤å¼ï¼ˆå…³æ³¨è¿‡ç¨‹ï¼‰ å£°æ˜å¼ï¼ˆå…³æ³¨ç»“æœï¼‰ è¿™éƒ¨åˆ†çš„é€‰æ‹©ä¸»è¦åŸºäºä¸¤ä¸ªæ–¹é¢ï¼šæ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚ å› ä¸ºå£°æ˜å¼åœ¨å‘½ä»¤å¼æ€§èƒ½æ¶ˆè€—çš„åŸºç¡€ä¸Šå¤šå‡ºäº†diffçš„æ€§èƒ½æ¶ˆè€—ï¼Œæ‰€ä»¥åœ¨æ€§èƒ½ä¸Šä¼šå·®ä¸€äº› ä½†éšä¹‹å¸¦æ¥çš„æ˜¯å¯ç»´æŠ¤æ€§çš„å·¨å¤§æå‡ Vueå°è£…å‘½ä»¤å¼çš„ä»£..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-19T13:13:32.000Z"}],["meta",{"property":"article:author","content":"Dachao"}],["meta",{"property":"article:modified_time","content":"2024-03-19T13:13:32.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"vueçš„è®¾è®¡ä¸å®ç°ï¼ˆ1-4ç« ï¼‰\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-19T13:13:32.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Dachao\\",\\"email\\":\\"wyc168hard@163.com\\"}]}"]]},"headers":[{"level":2,"title":"ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©ï¼ˆæƒè¡¡ï¼‰","slug":"ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©-æƒè¡¡","link":"#ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©-æƒè¡¡","children":[{"level":3,"title":"1. å£°æ˜å¼orå‘½ä»¤å¼","slug":"_1-å£°æ˜å¼orå‘½ä»¤å¼","link":"#_1-å£°æ˜å¼orå‘½ä»¤å¼","children":[]},{"level":3,"title":"2. è™šæ‹Ÿdomçš„é€‰æ‹©","slug":"_2-è™šæ‹Ÿdomçš„é€‰æ‹©","link":"#_2-è™šæ‹Ÿdomçš„é€‰æ‹©","children":[]},{"level":3,"title":"3. è¿è¡Œæ—¶orç¼–è¯‘æ—¶","slug":"_3-è¿è¡Œæ—¶orç¼–è¯‘æ—¶","link":"#_3-è¿è¡Œæ—¶orç¼–è¯‘æ—¶","children":[]}]},{"level":2,"title":"äºŒã€ æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒè¦ç´ ","slug":"äºŒã€-æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒè¦ç´ ","link":"#äºŒã€-æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒè¦ç´ ","children":[]},{"level":2,"title":"ä¸‰ã€Vue3çš„è®¾è®¡æ€è·¯","slug":"ä¸‰ã€vue3çš„è®¾è®¡æ€è·¯","link":"#ä¸‰ã€vue3çš„è®¾è®¡æ€è·¯","children":[{"level":3,"title":"1. æè¿°UI","slug":"_1-æè¿°ui","link":"#_1-æè¿°ui","children":[]},{"level":3,"title":"2. æ¸²æŸ“å™¨","slug":"_2-æ¸²æŸ“å™¨","link":"#_2-æ¸²æŸ“å™¨","children":[]},{"level":3,"title":"3. ç»„ä»¶","slug":"_3-ç»„ä»¶","link":"#_3-ç»„ä»¶","children":[]},{"level":3,"title":"4. ç¼–è¯‘å™¨","slug":"_4-ç¼–è¯‘å™¨","link":"#_4-ç¼–è¯‘å™¨","children":[]},{"level":3,"title":"5. é¡µé¢æ¸²æŸ“æµç¨‹","slug":"_5-é¡µé¢æ¸²æŸ“æµç¨‹","link":"#_5-é¡µé¢æ¸²æŸ“æµç¨‹","children":[]}]},{"level":2,"title":"å››ã€å“åº”ç³»ç»Ÿçš„ä½œç”¨ä¸å®ç°","slug":"å››ã€å“åº”ç³»ç»Ÿçš„ä½œç”¨ä¸å®ç°","link":"#å››ã€å“åº”ç³»ç»Ÿçš„ä½œç”¨ä¸å®ç°","children":[{"level":3,"title":"1. å“åº”å¼æ•°æ®ä¸å‰¯ä½œç”¨å‡½æ•°","slug":"_1-å“åº”å¼æ•°æ®ä¸å‰¯ä½œç”¨å‡½æ•°","link":"#_1-å“åº”å¼æ•°æ®ä¸å‰¯ä½œç”¨å‡½æ•°","children":[]},{"level":3,"title":"2. å®Œæˆå“åº”å¼çš„åŸºæœ¬æ€è·¯","slug":"_2-å®Œæˆå“åº”å¼çš„åŸºæœ¬æ€è·¯","link":"#_2-å®Œæˆå“åº”å¼çš„åŸºæœ¬æ€è·¯","children":[]},{"level":3,"title":"3. è¾ƒå®Œå–„å“åº”å¼çš„å®ç°","slug":"_3-è¾ƒå®Œå–„å“åº”å¼çš„å®ç°","link":"#_3-è¾ƒå®Œå–„å“åº”å¼çš„å®ç°","children":[]},{"level":3,"title":"4. è®¡ç®—å±æ€§computedçš„å®ç°","slug":"_4-è®¡ç®—å±æ€§computedçš„å®ç°","link":"#_4-è®¡ç®—å±æ€§computedçš„å®ç°","children":[]},{"level":3,"title":"5. watchçš„å®ç°","slug":"_5-watchçš„å®ç°","link":"#_5-watchçš„å®ç°","children":[]}]}],"git":{"createdTime":1710854012000,"updatedTime":1710854012000,"contributors":[{"name":"dachao","email":"1114686398@qq.com","commits":1}]},"readingTime":{"minutes":21.46,"words":6439},"filePathRelative":"source_code/vue3/vuejs1-4.md","localizedDate":"2024å¹´3æœˆ19æ—¥","excerpt":"\\n<blockquote>\\n<p>éœæ˜¥é˜³ã€ŠVue.jsè®¾è®¡ä¸å®ç°ã€‹çš„ç¬”è®°</p>\\n</blockquote>\\n<h2>ä¸€ã€vueæ•´ä½“æ–¹å‘çš„é€‰æ‹©ï¼ˆæƒè¡¡ï¼‰</h2>\\n<h3>1. å£°æ˜å¼orå‘½ä»¤å¼</h3>\\n<p><strong>å‘½ä»¤å¼ï¼ˆå…³æ³¨è¿‡ç¨‹ï¼‰</strong></p>\\n<div class=\\"language-javascript\\" data-ext=\\"js\\" data-title=\\"js\\"><pre class=\\"language-javascript\\"><code><span class=\\"token keyword\\">const</span> div <span class=\\"token operator\\">=</span> document<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">querySelector</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'#app'</span><span class=\\"token punctuation\\">)</span> <span class=\\"token comment\\">// è·å– div</span>\\ndiv<span class=\\"token punctuation\\">.</span>innerText <span class=\\"token operator\\">=</span><span class=\\"token string\\">'hello world'</span> <span class=\\"token comment\\">// è®¾ç½®æ–‡æœ¬å†…å®¹</span>\\ndiv<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">addEventlistener</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'click'</span><span class=\\"token function\\">ï¼Œ</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">=&gt;</span><span class=\\"token punctuation\\">[</span> <span class=\\"token function\\">alert</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'ok'</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span> <span class=\\"token comment\\">// ç»‘å®šç‚¹å‡»äº‹ä»¶</span>\\n</code></pre></div>","autoDesc":true}`);export{xn as comp,Fn as data};

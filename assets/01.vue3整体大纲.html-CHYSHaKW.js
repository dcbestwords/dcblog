import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,e as t}from"./app-B34r8jOc.js";const e="/dcblog/assets/compare-Ct7H-ISV.png",p="/dcblog/assets/1-BlOQ6Fhm.png",o={},c=t(`<h1 id="_1-vue3整体大纲" tabindex="-1"><a class="header-anchor" href="#_1-vue3整体大纲"><span>1. vue3整体大纲</span></a></h1><blockquote><p>霍春阳《Vue.js设计与实现》的笔记</p></blockquote><h2 id="一、vue整体方向的选择-权衡" tabindex="-1"><a class="header-anchor" href="#一、vue整体方向的选择-权衡"><span>一、vue整体方向的选择（权衡）</span></a></h2><h3 id="_1-声明式or命令式" tabindex="-1"><a class="header-anchor" href="#_1-声明式or命令式"><span>1. 声明式or命令式</span></a></h3><p><strong>命令式（关注过程）</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 获取 div</span>
div<span class="token punctuation">.</span>innerText <span class="token operator">=</span><span class="token string">&#39;hello world&#39;</span> <span class="token comment">// 设置文本内容</span>
div<span class="token punctuation">.</span><span class="token function">addEventlistener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token function">，</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">[</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;ok&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 绑定点击事件</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>声明式（关注结果）</strong></p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>()=&gt; alert(&#39;ok&#39;)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>hello world<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这部分的选择主要基于两个方面：<strong>性能</strong>和<strong>可维护性</strong>。</p><table><thead><tr><th style="text-align:center;"></th><th style="text-align:center;">性能</th><th style="text-align:center;">可维护性</th></tr></thead><tbody><tr><td style="text-align:center;">对比</td><td style="text-align:center;">命令式 &gt; 声明式</td><td style="text-align:center;">声明式 &gt;&gt; 命令式</td></tr></tbody></table><ul><li>因为声明式在命令式性能消耗的基础上多出了<strong>diff的性能消耗</strong>，所以在性能上会差一些</li><li>但随之带来的是可维护性的巨大提升</li></ul><blockquote><p>Vue封装命令式的代码，实现面向用户的声明式</p></blockquote><h3 id="_2-虚拟dom的选择" tabindex="-1"><a class="header-anchor" href="#_2-虚拟dom的选择"><span>2. 虚拟dom的选择</span></a></h3><p>上面提到声明式带来的额外性能消耗——<strong>diff的性能消耗</strong>，虚拟dom便是为了最小化此消耗采取的措施。其中虚拟dom是一个普通的JS对象，用来表示对真实dom的描述。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;span&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">&#39;hello world&#39;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+e+`" alt="image-20230321131551437" tabindex="0" loading="lazy"><figcaption>image-20230321131551437</figcaption></figure><h3 id="_3-运行时or编译时" tabindex="-1"><a class="header-anchor" href="#_3-运行时or编译时"><span>3. 运行时or编译时</span></a></h3><ul><li>运行时 <ul><li>利用 <code>render</code> 函数，直接把 <mark>虚拟DOM</mark> 转化为 <mark>真实DOM</mark> 元素</li><li>没有编译过程，无法分析用户提供的内容</li><li>需要我们手写<code>render</code>函数（😖）</li></ul></li><li>编译时 <ul><li>直接把 <mark>template 模板</mark> 中的内容，转化为 <mark>真实 DOM</mark> 元素</li><li>可以分析用户提供的内容，理论上性能会更好，但是有损灵活性</li></ul></li><li>运行时编译（Vue选用） <ul><li>先把 <mark>template 模板</mark> 转化为 <mark>render 函数</mark></li><li>再利用render 函数，把 <mark>虚拟 DOM</mark> 转化为 <mark>真实 DOM</mark></li></ul></li></ul><h2 id="二、-框架设计的核心要素" tabindex="-1"><a class="header-anchor" href="#二、-框架设计的核心要素"><span>二、 框架设计的核心要素</span></a></h2><ul><li><p>提升用户的开发体验</p><ul><li>引入友好的警告信息，帮助开发者里快速定位问题</li><li>警告信息详细导致框架体积增大，通过判断所处环境来决定构建的版本是否包含这些警告信息</li></ul></li><li><p>引入<code>Tree-Shaking</code>机制</p><ul><li>配合预定义变量，排除dead code，缩小打包体积</li></ul></li><li><p>根据应用环境的不同输出不同的构建产物（ <mark>多版本</mark>）</p></li><li><p>提供功能的特性开关，让用户自由选择是否使用</p></li><li><p>提供统一的错误处理接口：<code>callWithErrorHandling</code></p></li><li><p>提供良好的TS类型支持</p></li></ul><h2 id="三、vue3的设计思路" tabindex="-1"><a class="header-anchor" href="#三、vue3的设计思路"><span>三、Vue3的设计思路</span></a></h2><h3 id="_1-描述ui" tabindex="-1"><a class="header-anchor" href="#_1-描述ui"><span>1. 描述UI</span></a></h3><p>Vue3中支持两种方式来描述UI。第一种是 <mark>模板</mark>，即我们常在template标签中书写的内容：</p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handler<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>这种方式vue最终还是会将其编译为<code>render</code>函数（通过<strong>编译器</strong>）</li></ul><p>另外一种是直接使用js对象来描述UI，即所谓的 <mark>虚拟DOM</mark>。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">&#39;h1&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">onClick</span><span class="token operator">:</span> handler <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 虚拟 DOM</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>render</code>函数运行返回一个虚拟DOM对象</li><li>其中h为辅助创建虚拟DOM的工具函数</li></ul><h3 id="_2-渲染器" tabindex="-1"><a class="header-anchor" href="#_2-渲染器"><span>2. 渲染器</span></a></h3><p>渲染器的作用就是 <mark>把虚拟 DOM 渲染为真实 DOM</mark>，以下是一个不考虑更新节点的简易版本</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">renderer</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用 vnode.tag 作为标签名称创建 DOM 元素</span>
    <span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>tag<span class="token punctuation">)</span>
    <span class="token comment">// 遍历 vnode.props，将属性、事件添加到 DOM 元素</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^on</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 如果 key 以 on 开头，说明它是事件</span>
            el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
                key<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 事件名称 onClick ---&gt;click</span>
                vnode<span class="token punctuation">.</span>props<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token comment">// 事件处理函数</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 处理 children</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>children <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果 children 是字符串，说明它是元素的文本子节点</span>
        el<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 递归地调用 renderer 函数渲染子节点，使用当前元素 el 作为挂载点</span>
        vnode<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token function">renderer</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 将元素添加到挂载点下</span>
    container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-组件" tabindex="-1"><a class="header-anchor" href="#_3-组件"><span>3. 组件</span></a></h3><p><mark>组件就是一组DOM元素的封装</mark>，这组DOM元素就是组件要渲染的内容。而虚拟DOM不光可以用来描述真实DOM，还可以用来描述组件，只是其中<code>tag</code>变成了组件。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> MyComponent
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">//MyComponent是一个对象</span>
<span class="token keyword">const</span> MyComponent <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">{</span>
            <span class="token literal-property property">tag</span><span class="token operator">:</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">props</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token function-variable function">onclick</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">alert</span> <span class="token punctuation">(</span><span class="token string">&#39;hello&#39;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">children</span><span class="token operator">:</span><span class="token string">&#39;click me&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//MyComponent是一个函数</span>
<span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;hello&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">&#39;click me&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>MyComponent</code>可以是函数，可以是对象，只要最终返回的是一组虚拟dom即可。我们根据<code>MyComponent</code>的类型对渲染器进行相应的修改</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">renderer</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 说明 vnode 描述的是标签元素</span>
        <span class="token function">mountElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//或者=== &#39;Object&#39;</span>
        <span class="token comment">// 说明 vnode 描述的是组件</span>
        <span class="token function">mountComponent</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中mountElement即上述渲染器的部分，而新加的处理组件的函数<code>mountComponent</code>，大致流程为：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用组件函数，获取组件要渲染的内容（虚拟 DOM）</span>
    <span class="token keyword">const</span> subtree <span class="token operator">=</span> vnode<span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//vnode.tag.render()</span>
    <span class="token comment">// 递归地调用 renderer 渲染 subtree</span>
    <span class="token function">renderer</span><span class="token punctuation">(</span>subtree<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-编译器" tabindex="-1"><a class="header-anchor" href="#_4-编译器"><span>4. 编译器</span></a></h3><p>编译器的作用是 <mark>将模板编译为渲染函数</mark>，对于编译器来说，模板就是一个普通的字符串，它会分析该字符 串并生成一个功能与之相同的渲染函数</p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handler<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    	click me
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;template&gt;</code> 标签里的内容就是模板内容，编译器会把模板内容 编译成渲染函数并添加到 <code>&lt;script&gt;</code>标签块的组件对象上，所以最终在浏览器里运行的代码就是：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">onClick</span><span class="token operator">:</span> handler <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;click me&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-页面渲染流程" tabindex="-1"><a class="header-anchor" href="#_5-页面渲染流程"><span>5. 页面渲染流程</span></a></h3><figure><img src="`+p+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',46),l=[c];function i(u,r){return s(),a("div",null,l)}const v=n(o,[["render",i],["__file","01.vue3整体大纲.html.vue"]]),m=JSON.parse(`{"path":"/source_code/vue3/01.vue3%E6%95%B4%E4%BD%93%E5%A4%A7%E7%BA%B2.html","title":"1. vue3整体大纲","lang":"zh-CN","frontmatter":{"description":"1. vue3整体大纲 霍春阳《Vue.js设计与实现》的笔记 一、vue整体方向的选择（权衡） 1. 声明式or命令式 命令式（关注过程） 声明式（关注结果） 这部分的选择主要基于两个方面：性能和可维护性。 因为声明式在命令式性能消耗的基础上多出了diff的性能消耗，所以在性能上会差一些 但随之带来的是可维护性的巨大提升 Vue封装命令式的代码，实现...","head":[["meta",{"property":"og:url","content":"https://github.com/dcblog/source_code/vue3/01.vue3%E6%95%B4%E4%BD%93%E5%A4%A7%E7%BA%B2.html"}],["meta",{"property":"og:site_name","content":"dcBlog"}],["meta",{"property":"og:title","content":"1. vue3整体大纲"}],["meta",{"property":"og:description","content":"1. vue3整体大纲 霍春阳《Vue.js设计与实现》的笔记 一、vue整体方向的选择（权衡） 1. 声明式or命令式 命令式（关注过程） 声明式（关注结果） 这部分的选择主要基于两个方面：性能和可维护性。 因为声明式在命令式性能消耗的基础上多出了diff的性能消耗，所以在性能上会差一些 但随之带来的是可维护性的巨大提升 Vue封装命令式的代码，实现..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-29T16:36:49.000Z"}],["meta",{"property":"article:author","content":"Dachao"}],["meta",{"property":"article:modified_time","content":"2024-08-29T16:36:49.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"1. vue3整体大纲\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-08-29T16:36:49.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Dachao\\",\\"email\\":\\"wyc168hard@163.com\\"}]}"]]},"headers":[{"level":2,"title":"一、vue整体方向的选择（权衡）","slug":"一、vue整体方向的选择-权衡","link":"#一、vue整体方向的选择-权衡","children":[{"level":3,"title":"1. 声明式or命令式","slug":"_1-声明式or命令式","link":"#_1-声明式or命令式","children":[]},{"level":3,"title":"2. 虚拟dom的选择","slug":"_2-虚拟dom的选择","link":"#_2-虚拟dom的选择","children":[]},{"level":3,"title":"3. 运行时or编译时","slug":"_3-运行时or编译时","link":"#_3-运行时or编译时","children":[]}]},{"level":2,"title":"二、 框架设计的核心要素","slug":"二、-框架设计的核心要素","link":"#二、-框架设计的核心要素","children":[]},{"level":2,"title":"三、Vue3的设计思路","slug":"三、vue3的设计思路","link":"#三、vue3的设计思路","children":[{"level":3,"title":"1. 描述UI","slug":"_1-描述ui","link":"#_1-描述ui","children":[]},{"level":3,"title":"2. 渲染器","slug":"_2-渲染器","link":"#_2-渲染器","children":[]},{"level":3,"title":"3. 组件","slug":"_3-组件","link":"#_3-组件","children":[]},{"level":3,"title":"4. 编译器","slug":"_4-编译器","link":"#_4-编译器","children":[]},{"level":3,"title":"5. 页面渲染流程","slug":"_5-页面渲染流程","link":"#_5-页面渲染流程","children":[]}]}],"git":{"createdTime":1720786104000,"updatedTime":1724949409000,"contributors":[{"name":"dachao","email":"1114686398@qq.com","commits":2}]},"readingTime":{"minutes":4.59,"words":1378},"filePathRelative":"source_code/vue3/01.vue3整体大纲.md","localizedDate":"2024年7月12日","excerpt":"\\n<blockquote>\\n<p>霍春阳《Vue.js设计与实现》的笔记</p>\\n</blockquote>\\n<h2>一、vue整体方向的选择（权衡）</h2>\\n<h3>1. 声明式or命令式</h3>\\n<p><strong>命令式（关注过程）</strong></p>\\n<div class=\\"language-javascript\\" data-ext=\\"js\\" data-title=\\"js\\"><pre class=\\"language-javascript\\"><code><span class=\\"token keyword\\">const</span> div <span class=\\"token operator\\">=</span> document<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">querySelector</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'#app'</span><span class=\\"token punctuation\\">)</span> <span class=\\"token comment\\">// 获取 div</span>\\ndiv<span class=\\"token punctuation\\">.</span>innerText <span class=\\"token operator\\">=</span><span class=\\"token string\\">'hello world'</span> <span class=\\"token comment\\">// 设置文本内容</span>\\ndiv<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">addEventlistener</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'click'</span><span class=\\"token function\\">，</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">=&gt;</span><span class=\\"token punctuation\\">[</span> <span class=\\"token function\\">alert</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'ok'</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span> <span class=\\"token comment\\">// 绑定点击事件</span>\\n</code></pre></div>","autoDesc":true}`);export{v as comp,m as data};
